<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="robots" content="noindex">

	<title>File salesforce_push.php | Object Sync for Salesforce</title>

	<link rel="stylesheet" href="resources/style.css?c2f33731c1948fbed7c333554678bfa68d4817da">

</head>

<body>
<div id="left">
	<div id="menu">
		<a href="index.html" title="Overview"><span>Overview</span></a>


		<div id="groups">
		</div>



		<div id="elements">
			<h3>Classes</h3>
			<ul>
				<li><a href="class-Object_Sync_Salesforce.html">Object_Sync_Salesforce</a></li>
				<li><a href="class-Object_Sync_Sf_Activate.html">Object_Sync_Sf_Activate</a></li>
				<li><a href="class-Object_Sync_Sf_Admin.html">Object_Sync_Sf_Admin</a></li>
				<li><a href="class-Object_Sync_Sf_Admin_Notice.html">Object_Sync_Sf_Admin_Notice</a></li>
				<li><a href="class-Object_Sync_Sf_Deactivate.html">Object_Sync_Sf_Deactivate</a></li>
				<li><a href="class-Object_Sync_Sf_Logging.html">Object_Sync_Sf_Logging</a></li>
				<li><a href="class-Object_Sync_Sf_Mapping.html">Object_Sync_Sf_Mapping</a></li>
				<li><a href="class-Object_Sync_Sf_Salesforce.html">Object_Sync_Sf_Salesforce</a></li>
				<li><a href="class-Object_Sync_Sf_Salesforce_Pull.html">Object_Sync_Sf_Salesforce_Pull</a></li>
				<li><a href="class-Object_Sync_Sf_Salesforce_Push.html">Object_Sync_Sf_Salesforce_Push</a></li>
				<li><a href="class-Object_Sync_Sf_Salesforce_Select_Query.html">Object_Sync_Sf_Salesforce_Select_Query</a></li>
				<li><a href="class-Object_Sync_Sf_Salesforce_Soap_Partner.html">Object_Sync_Sf_Salesforce_Soap_Partner</a></li>
				<li><a href="class-Object_Sync_Sf_Schedule.html">Object_Sync_Sf_Schedule</a></li>
				<li><a href="class-Object_Sync_Sf_WordPress.html">Object_Sync_Sf_WordPress</a></li>
				<li><a href="class-Object_Sync_Sf_WordPress_Transient.html">Object_Sync_Sf_WordPress_Transient</a></li>
			</ul>



			<h3>Exceptions</h3>
			<ul>
				<li><a href="class-Object_Sync_Sf_Exception.html">Object_Sync_Sf_Exception</a></li>
				<li><a href="class-WordpressException.html">WordpressException</a></li>
			</ul>


		</div>
	</div>
</div>

<div id="splitter"></div>

<div id="right">
<div id="rightInner">
	<form id="search">
		<input type="hidden" name="cx" value="">
		<input type="hidden" name="ie" value="UTF-8">
		<input type="text" name="q" class="text" placeholder="Search">
	</form>

	<div id="navigation">
		<ul>
			<li>
				<a href="index.html" title="Overview"><span>Overview</span></a>
			</li>
			<li>
<span>Class</span>			</li>
		</ul>
		<ul>
				<li>
					<a href="annotation-group-todo.html" title="List of elements with todo annotation">
						<span>Todo</span>
					</a>
				</li>
		</ul>
		<ul>
		</ul>
	</div>

<pre class="numbers"><code><span class="l"><a href="#1">   1: </a></span><span class="l"><a href="#2">   2: </a></span></span><span class="l"><a href="#3">   3: </a></span></span><span class="l"><a href="#4">   4: </a></span></span><span class="l"><a href="#5">   5: </a></span></span><span class="l"><a href="#6">   6: </a></span><span class="l"><a href="#7">   7: </a></span><span class="l"><a href="#8">   8: </a></span><span class="l"><a href="#9">   9: </a></span><span class="l"><a href="#10">  10: </a></span><span class="l"><a href="#11">  11: </a></span><span class="l"><a href="#12">  12: </a></span></span><span class="l"><a href="#13">  13: </a></span></span><span class="l"><a href="#14">  14: </a></span><span class="l"><a href="#15">  15: </a></span><span class="l"><a href="#16">  16: </a></span><span class="l"><a href="#17">  17: </a></span><span class="l"><a href="#18">  18: </a></span><span class="l"><a href="#19">  19: </a></span><span class="l"><a href="#20">  20: </a></span><span class="l"><a href="#21">  21: </a></span><span class="l"><a href="#22">  22: </a></span><span class="l"><a href="#23">  23: </a></span><span class="l"><a href="#24">  24: </a></span><span class="l"><a href="#25">  25: </a></span><span class="l"><a href="#26">  26: </a></span></span><span class="l"><a href="#27">  27: </a></span></span><span class="l"><a href="#28">  28: </a></span><span class="l"><a href="#29">  29: </a></span><span class="l"><a href="#30">  30: </a></span><span class="l"><a href="#31">  31: </a></span></span><span class="l"><a href="#32">  32: </a></span></span><span class="l"><a href="#33">  33: </a></span></span><span class="l"><a href="#34">  34: </a></span></span><span class="l"><a href="#35">  35: </a></span></span><span class="l"><a href="#36">  36: </a></span></span><span class="l"><a href="#37">  37: </a></span></span><span class="l"><a href="#38">  38: </a></span></span><span class="l"><a href="#39">  39: </a></span></span><span class="l"><a href="#40">  40: </a></span></span><span class="l"><a href="#41">  41: </a></span></span><span class="l"><a href="#42">  42: </a></span></span><span class="l"><a href="#43">  43: </a></span></span><span class="l"><a href="#44">  44: </a></span><span class="l"><a href="#45">  45: </a></span><span class="l"><a href="#46">  46: </a></span><span class="l"><a href="#47">  47: </a></span><span class="l"><a href="#48">  48: </a></span><span class="l"><a href="#49">  49: </a></span><span class="l"><a href="#50">  50: </a></span><span class="l"><a href="#51">  51: </a></span><span class="l"><a href="#52">  52: </a></span><span class="l"><a href="#53">  53: </a></span><span class="l"><a href="#54">  54: </a></span><span class="l"><a href="#55">  55: </a></span><span class="l"><a href="#56">  56: </a></span><span class="l"><a href="#57">  57: </a></span><span class="l"><a href="#58">  58: </a></span><span class="l"><a href="#59">  59: </a></span><span class="l"><a href="#60">  60: </a></span><span class="l"><a href="#61">  61: </a></span><span class="l"><a href="#62">  62: </a></span><span class="l"><a href="#63">  63: </a></span><span class="l"><a href="#64">  64: </a></span></span><span class="l"><a href="#65">  65: </a></span></span><span class="l"><a href="#66">  66: </a></span></span><span class="l"><a href="#67">  67: </a></span></span><span class="l"><a href="#68">  68: </a></span><span class="l"><a href="#69">  69: </a></span><span class="l"><a href="#70">  70: </a></span><span class="l"><a href="#71">  71: </a></span><span class="l"><a href="#72">  72: </a></span><span class="l"><a href="#73">  73: </a></span><span class="l"><a href="#74">  74: </a></span><span class="l"><a href="#75">  75: </a></span><span class="l"><a href="#76">  76: </a></span><span class="l"><a href="#77">  77: </a></span><span class="l"><a href="#78">  78: </a></span><span class="l"><a href="#79">  79: </a></span><span class="l"><a href="#80">  80: </a></span><span class="l"><a href="#81">  81: </a></span><span class="l"><a href="#82">  82: </a></span><span class="l"><a href="#83">  83: </a></span><span class="l"><a href="#84">  84: </a></span><span class="l"><a href="#85">  85: </a></span><span class="l"><a href="#86">  86: </a></span><span class="l"><a href="#87">  87: </a></span><span class="l"><a href="#88">  88: </a></span><span class="l"><a href="#89">  89: </a></span><span class="l"><a href="#90">  90: </a></span><span class="l"><a href="#91">  91: </a></span><span class="l"><a href="#92">  92: </a></span><span class="l"><a href="#93">  93: </a></span><span class="l"><a href="#94">  94: </a></span><span class="l"><a href="#95">  95: </a></span><span class="l"><a href="#96">  96: </a></span><span class="l"><a href="#97">  97: </a></span><span class="l"><a href="#98">  98: </a></span><span class="l"><a href="#99">  99: </a></span><span class="l"><a href="#100"> 100: </a></span></span><span class="l"><a href="#101"> 101: </a></span></span><span class="l"><a href="#102"> 102: </a></span></span><span class="l"><a href="#103"> 103: </a></span></span><span class="l"><a href="#104"> 104: </a></span></span><span class="l"><a href="#105"> 105: </a></span></span><span class="l"><a href="#106"> 106: </a></span><span class="l"><a href="#107"> 107: </a></span><span class="l"><a href="#108"> 108: </a></span><span class="l"><a href="#109"> 109: </a></span><span class="l"><a href="#110"> 110: </a></span><span class="l"><a href="#111"> 111: </a></span></span><span class="l"><a href="#112"> 112: </a></span></span><span class="l"><a href="#113"> 113: </a></span></span><span class="l"><a href="#114"> 114: </a></span></span><span class="l"><a href="#115"> 115: </a></span><span class="l"><a href="#116"> 116: </a></span><span class="l"><a href="#117"> 117: </a></span><span class="l"><a href="#118"> 118: </a></span><span class="l"><a href="#119"> 119: </a></span><span class="l"><a href="#120"> 120: </a></span><span class="l"><a href="#121"> 121: </a></span></span><span class="l"><a href="#122"> 122: </a></span></span><span class="l"><a href="#123"> 123: </a></span></span><span class="l"><a href="#124"> 124: </a></span></span><span class="l"><a href="#125"> 125: </a></span></span><span class="l"><a href="#126"> 126: </a></span><span class="l"><a href="#127"> 127: </a></span><span class="l"><a href="#128"> 128: </a></span><span class="l"><a href="#129"> 129: </a></span><span class="l"><a href="#130"> 130: </a></span><span class="l"><a href="#131"> 131: </a></span><span class="l"><a href="#132"> 132: </a></span></span><span class="l"><a href="#133"> 133: </a></span></span><span class="l"><a href="#134"> 134: </a></span></span><span class="l"><a href="#135"> 135: </a></span></span><span class="l"><a href="#136"> 136: </a></span><span class="l"><a href="#137"> 137: </a></span><span class="l"><a href="#138"> 138: </a></span><span class="l"><a href="#139"> 139: </a></span><span class="l"><a href="#140"> 140: </a></span><span class="l"><a href="#141"> 141: </a></span><span class="l"><a href="#142"> 142: </a></span></span><span class="l"><a href="#143"> 143: </a></span></span><span class="l"><a href="#144"> 144: </a></span></span><span class="l"><a href="#145"> 145: </a></span></span><span class="l"><a href="#146"> 146: </a></span></span><span class="l"><a href="#147"> 147: </a></span></span><span class="l"><a href="#148"> 148: </a></span><span class="l"><a href="#149"> 149: </a></span><span class="l"><a href="#150"> 150: </a></span><span class="l"><a href="#151"> 151: </a></span><span class="l"><a href="#152"> 152: </a></span><span class="l"><a href="#153"> 153: </a></span><span class="l"><a href="#154"> 154: </a></span><span class="l"><a href="#155"> 155: </a></span><span class="l"><a href="#156"> 156: </a></span><span class="l"><a href="#157"> 157: </a></span><span class="l"><a href="#158"> 158: </a></span><span class="l"><a href="#159"> 159: </a></span><span class="l"><a href="#160"> 160: </a></span><span class="l"><a href="#161"> 161: </a></span><span class="l"><a href="#162"> 162: </a></span><span class="l"><a href="#163"> 163: </a></span><span class="l"><a href="#164"> 164: </a></span><span class="l"><a href="#165"> 165: </a></span><span class="l"><a href="#166"> 166: </a></span><span class="l"><a href="#167"> 167: </a></span><span class="l"><a href="#168"> 168: </a></span><span class="l"><a href="#169"> 169: </a></span><span class="l"><a href="#170"> 170: </a></span><span class="l"><a href="#171"> 171: </a></span><span class="l"><a href="#172"> 172: </a></span><span class="l"><a href="#173"> 173: </a></span><span class="l"><a href="#174"> 174: </a></span><span class="l"><a href="#175"> 175: </a></span><span class="l"><a href="#176"> 176: </a></span><span class="l"><a href="#177"> 177: </a></span><span class="l"><a href="#178"> 178: </a></span><span class="l"><a href="#179"> 179: </a></span><span class="l"><a href="#180"> 180: </a></span><span class="l"><a href="#181"> 181: </a></span><span class="l"><a href="#182"> 182: </a></span><span class="l"><a href="#183"> 183: </a></span><span class="l"><a href="#184"> 184: </a></span><span class="l"><a href="#185"> 185: </a></span><span class="l"><a href="#186"> 186: </a></span><span class="l"><a href="#187"> 187: </a></span><span class="l"><a href="#188"> 188: </a></span><span class="l"><a href="#189"> 189: </a></span><span class="l"><a href="#190"> 190: </a></span><span class="l"><a href="#191"> 191: </a></span><span class="l"><a href="#192"> 192: </a></span><span class="l"><a href="#193"> 193: </a></span><span class="l"><a href="#194"> 194: </a></span></span><span class="l"><a href="#195"> 195: </a></span></span><span class="l"><a href="#196"> 196: </a></span></span><span class="l"><a href="#197"> 197: </a></span></span><span class="l"><a href="#198"> 198: </a></span><span class="l"><a href="#199"> 199: </a></span><span class="l"><a href="#200"> 200: </a></span><span class="l"><a href="#201"> 201: </a></span><span class="l"><a href="#202"> 202: </a></span><span class="l"><a href="#203"> 203: </a></span><span class="l"><a href="#204"> 204: </a></span></span><span class="l"><a href="#205"> 205: </a></span></span><span class="l"><a href="#206"> 206: </a></span></span><span class="l"><a href="#207"> 207: </a></span></span><span class="l"><a href="#208"> 208: </a></span><span class="l"><a href="#209"> 209: </a></span><span class="l"><a href="#210"> 210: </a></span><span class="l"><a href="#211"> 211: </a></span><span class="l"><a href="#212"> 212: </a></span><span class="l"><a href="#213"> 213: </a></span><span class="l"><a href="#214"> 214: </a></span></span><span class="l"><a href="#215"> 215: </a></span></span><span class="l"><a href="#216"> 216: </a></span></span><span class="l"><a href="#217"> 217: </a></span></span><span class="l"><a href="#218"> 218: </a></span><span class="l"><a href="#219"> 219: </a></span><span class="l"><a href="#220"> 220: </a></span><span class="l"><a href="#221"> 221: </a></span><span class="l"><a href="#222"> 222: </a></span><span class="l"><a href="#223"> 223: </a></span><span class="l"><a href="#224"> 224: </a></span></span><span class="l"><a href="#225"> 225: </a></span></span><span class="l"><a href="#226"> 226: </a></span></span><span class="l"><a href="#227"> 227: </a></span></span><span class="l"><a href="#228"> 228: </a></span></span><span class="l"><a href="#229"> 229: </a></span></span><span class="l"><a href="#230"> 230: </a></span><span class="l"><a href="#231"> 231: </a></span><span class="l"><a href="#232"> 232: </a></span><span class="l"><a href="#233"> 233: </a></span><span class="l"><a href="#234"> 234: </a></span><span class="l"><a href="#235"> 235: </a></span><span class="l"><a href="#236"> 236: </a></span></span><span class="l"><a href="#237"> 237: </a></span></span><span class="l"><a href="#238"> 238: </a></span></span><span class="l"><a href="#239"> 239: </a></span></span><span class="l"><a href="#240"> 240: </a></span></span><span class="l"><a href="#241"> 241: </a></span><span class="l"><a href="#242"> 242: </a></span><span class="l"><a href="#243"> 243: </a></span><span class="l"><a href="#244"> 244: </a></span><span class="l"><a href="#245"> 245: </a></span><span class="l"><a href="#246"> 246: </a></span><span class="l"><a href="#247"> 247: </a></span></span><span class="l"><a href="#248"> 248: </a></span></span><span class="l"><a href="#249"> 249: </a></span></span><span class="l"><a href="#250"> 250: </a></span></span><span class="l"><a href="#251"> 251: </a></span></span><span class="l"><a href="#252"> 252: </a></span></span><span class="l"><a href="#253"> 253: </a></span></span><span class="l"><a href="#254"> 254: </a></span><span class="l"><a href="#255"> 255: </a></span><span class="l"><a href="#256"> 256: </a></span><span class="l"><a href="#257"> 257: </a></span><span class="l"><a href="#258"> 258: </a></span><span class="l"><a href="#259"> 259: </a></span><span class="l"><a href="#260"> 260: </a></span><span class="l"><a href="#261"> 261: </a></span></span><span class="l"><a href="#262"> 262: </a></span></span><span class="l"><a href="#263"> 263: </a></span></span><span class="l"><a href="#264"> 264: </a></span></span><span class="l"><a href="#265"> 265: </a></span></span><span class="l"><a href="#266"> 266: </a></span></span><span class="l"><a href="#267"> 267: </a></span><span class="l"><a href="#268"> 268: </a></span><span class="l"><a href="#269"> 269: </a></span><span class="l"><a href="#270"> 270: </a></span><span class="l"><a href="#271"> 271: </a></span><span class="l"><a href="#272"> 272: </a></span><span class="l"><a href="#273"> 273: </a></span></span><span class="l"><a href="#274"> 274: </a></span></span><span class="l"><a href="#275"> 275: </a></span></span><span class="l"><a href="#276"> 276: </a></span></span><span class="l"><a href="#277"> 277: </a></span><span class="l"><a href="#278"> 278: </a></span><span class="l"><a href="#279"> 279: </a></span><span class="l"><a href="#280"> 280: </a></span><span class="l"><a href="#281"> 281: </a></span><span class="l"><a href="#282"> 282: </a></span><span class="l"><a href="#283"> 283: </a></span></span><span class="l"><a href="#284"> 284: </a></span></span><span class="l"><a href="#285"> 285: </a></span></span><span class="l"><a href="#286"> 286: </a></span></span><span class="l"><a href="#287"> 287: </a></span><span class="l"><a href="#288"> 288: </a></span><span class="l"><a href="#289"> 289: </a></span><span class="l"><a href="#290"> 290: </a></span><span class="l"><a href="#291"> 291: </a></span><span class="l"><a href="#292"> 292: </a></span><span class="l"><a href="#293"> 293: </a></span></span><span class="l"><a href="#294"> 294: </a></span></span><span class="l"><a href="#295"> 295: </a></span></span><span class="l"><a href="#296"> 296: </a></span><span class="l"><a href="#297"> 297: </a></span><span class="l"><a href="#298"> 298: </a></span><span class="l"><a href="#299"> 299: </a></span><span class="l"><a href="#300"> 300: </a></span><span class="l"><a href="#301"> 301: </a></span></span><span class="l"><a href="#302"> 302: </a></span></span><span class="l"><a href="#303"> 303: </a></span></span><span class="l"><a href="#304"> 304: </a></span><span class="l"><a href="#305"> 305: </a></span><span class="l"><a href="#306"> 306: </a></span><span class="l"><a href="#307"> 307: </a></span><span class="l"><a href="#308"> 308: </a></span><span class="l"><a href="#309"> 309: </a></span></span><span class="l"><a href="#310"> 310: </a></span></span><span class="l"><a href="#311"> 311: </a></span></span><span class="l"><a href="#312"> 312: </a></span><span class="l"><a href="#313"> 313: </a></span><span class="l"><a href="#314"> 314: </a></span><span class="l"><a href="#315"> 315: </a></span><span class="l"><a href="#316"> 316: </a></span><span class="l"><a href="#317"> 317: </a></span></span><span class="l"><a href="#318"> 318: </a></span></span><span class="l"><a href="#319"> 319: </a></span></span><span class="l"><a href="#320"> 320: </a></span></span><span class="l"><a href="#321"> 321: </a></span></span><span class="l"><a href="#322"> 322: </a></span></span><span class="l"><a href="#323"> 323: </a></span></span><span class="l"><a href="#324"> 324: </a></span></span><span class="l"><a href="#325"> 325: </a></span></span><span class="l"><a href="#326"> 326: </a></span></span><span class="l"><a href="#327"> 327: </a></span></span><span class="l"><a href="#328"> 328: </a></span></span><span class="l"><a href="#329"> 329: </a></span></span><span class="l"><a href="#330"> 330: </a></span><span class="l"><a href="#331"> 331: </a></span><span class="l"><a href="#332"> 332: </a></span><span class="l"><a href="#333"> 333: </a></span><span class="l"><a href="#334"> 334: </a></span><span class="l"><a href="#335"> 335: </a></span><span class="l"><a href="#336"> 336: </a></span><span class="l"><a href="#337"> 337: </a></span><span class="l"><a href="#338"> 338: </a></span><span class="l"><a href="#339"> 339: </a></span><span class="l"><a href="#340"> 340: </a></span><span class="l"><a href="#341"> 341: </a></span><span class="l"><a href="#342"> 342: </a></span><span class="l"><a href="#343"> 343: </a></span><span class="l"><a href="#344"> 344: </a></span><span class="l"><a href="#345"> 345: </a></span><span class="l"><a href="#346"> 346: </a></span><span class="l"><a href="#347"> 347: </a></span><span class="l"><a href="#348"> 348: </a></span><span class="l"><a href="#349"> 349: </a></span><span class="l"><a href="#350"> 350: </a></span><span class="l"><a href="#351"> 351: </a></span><span class="l"><a href="#352"> 352: </a></span><span class="l"><a href="#353"> 353: </a></span><span class="l"><a href="#354"> 354: </a></span><span class="l"><a href="#355"> 355: </a></span><span class="l"><a href="#356"> 356: </a></span><span class="l"><a href="#357"> 357: </a></span><span class="l"><a href="#358"> 358: </a></span><span class="l"><a href="#359"> 359: </a></span><span class="l"><a href="#360"> 360: </a></span><span class="l"><a href="#361"> 361: </a></span><span class="l"><a href="#362"> 362: </a></span><span class="l"><a href="#363"> 363: </a></span><span class="l"><a href="#364"> 364: </a></span><span class="l"><a href="#365"> 365: </a></span><span class="l"><a href="#366"> 366: </a></span><span class="l"><a href="#367"> 367: </a></span><span class="l"><a href="#368"> 368: </a></span><span class="l"><a href="#369"> 369: </a></span><span class="l"><a href="#370"> 370: </a></span><span class="l"><a href="#371"> 371: </a></span><span class="l"><a href="#372"> 372: </a></span><span class="l"><a href="#373"> 373: </a></span><span class="l"><a href="#374"> 374: </a></span><span class="l"><a href="#375"> 375: </a></span><span class="l"><a href="#376"> 376: </a></span><span class="l"><a href="#377"> 377: </a></span><span class="l"><a href="#378"> 378: </a></span><span class="l"><a href="#379"> 379: </a></span><span class="l"><a href="#380"> 380: </a></span><span class="l"><a href="#381"> 381: </a></span><span class="l"><a href="#382"> 382: </a></span><span class="l"><a href="#383"> 383: </a></span><span class="l"><a href="#384"> 384: </a></span><span class="l"><a href="#385"> 385: </a></span><span class="l"><a href="#386"> 386: </a></span><span class="l"><a href="#387"> 387: </a></span><span class="l"><a href="#388"> 388: </a></span><span class="l"><a href="#389"> 389: </a></span><span class="l"><a href="#390"> 390: </a></span><span class="l"><a href="#391"> 391: </a></span><span class="l"><a href="#392"> 392: </a></span><span class="l"><a href="#393"> 393: </a></span><span class="l"><a href="#394"> 394: </a></span><span class="l"><a href="#395"> 395: </a></span><span class="l"><a href="#396"> 396: </a></span><span class="l"><a href="#397"> 397: </a></span><span class="l"><a href="#398"> 398: </a></span><span class="l"><a href="#399"> 399: </a></span><span class="l"><a href="#400"> 400: </a></span><span class="l"><a href="#401"> 401: </a></span></span><span class="l"><a href="#402"> 402: </a></span></span><span class="l"><a href="#403"> 403: </a></span></span><span class="l"><a href="#404"> 404: </a></span></span><span class="l"><a href="#405"> 405: </a></span></span><span class="l"><a href="#406"> 406: </a></span></span><span class="l"><a href="#407"> 407: </a></span></span><span class="l"><a href="#408"> 408: </a></span></span><span class="l"><a href="#409"> 409: </a></span><span class="l"><a href="#410"> 410: </a></span><span class="l"><a href="#411"> 411: </a></span><span class="l"><a href="#412"> 412: </a></span><span class="l"><a href="#413"> 413: </a></span><span class="l"><a href="#414"> 414: </a></span><span class="l"><a href="#415"> 415: </a></span><span class="l"><a href="#416"> 416: </a></span><span class="l"><a href="#417"> 417: </a></span><span class="l"><a href="#418"> 418: </a></span><span class="l"><a href="#419"> 419: </a></span><span class="l"><a href="#420"> 420: </a></span><span class="l"><a href="#421"> 421: </a></span><span class="l"><a href="#422"> 422: </a></span><span class="l"><a href="#423"> 423: </a></span><span class="l"><a href="#424"> 424: </a></span><span class="l"><a href="#425"> 425: </a></span><span class="l"><a href="#426"> 426: </a></span><span class="l"><a href="#427"> 427: </a></span><span class="l"><a href="#428"> 428: </a></span><span class="l"><a href="#429"> 429: </a></span><span class="l"><a href="#430"> 430: </a></span><span class="l"><a href="#431"> 431: </a></span><span class="l"><a href="#432"> 432: </a></span><span class="l"><a href="#433"> 433: </a></span><span class="l"><a href="#434"> 434: </a></span><span class="l"><a href="#435"> 435: </a></span><span class="l"><a href="#436"> 436: </a></span><span class="l"><a href="#437"> 437: </a></span><span class="l"><a href="#438"> 438: </a></span><span class="l"><a href="#439"> 439: </a></span><span class="l"><a href="#440"> 440: </a></span><span class="l"><a href="#441"> 441: </a></span><span class="l"><a href="#442"> 442: </a></span><span class="l"><a href="#443"> 443: </a></span><span class="l"><a href="#444"> 444: </a></span><span class="l"><a href="#445"> 445: </a></span><span class="l"><a href="#446"> 446: </a></span><span class="l"><a href="#447"> 447: </a></span><span class="l"><a href="#448"> 448: </a></span><span class="l"><a href="#449"> 449: </a></span><span class="l"><a href="#450"> 450: </a></span><span class="l"><a href="#451"> 451: </a></span><span class="l"><a href="#452"> 452: </a></span><span class="l"><a href="#453"> 453: </a></span><span class="l"><a href="#454"> 454: </a></span></span><span class="l"><a href="#455"> 455: </a></span></span><span class="l"><a href="#456"> 456: </a></span></span><span class="l"><a href="#457"> 457: </a></span></span><span class="l"><a href="#458"> 458: </a></span></span><span class="l"><a href="#459"> 459: </a></span></span><span class="l"><a href="#460"> 460: </a></span></span><span class="l"><a href="#461"> 461: </a></span></span><span class="l"><a href="#462"> 462: </a></span></span><span class="l"><a href="#463"> 463: </a></span></span><span class="l"><a href="#464"> 464: </a></span></span><span class="l"><a href="#465"> 465: </a></span></span><span class="l"><a href="#466"> 466: </a></span></span><span class="l"><a href="#467"> 467: </a></span></span><span class="l"><a href="#468"> 468: </a></span><span class="l"><a href="#469"> 469: </a></span><span class="l"><a href="#470"> 470: </a></span><span class="l"><a href="#471"> 471: </a></span><span class="l"><a href="#472"> 472: </a></span><span class="l"><a href="#473"> 473: </a></span><span class="l"><a href="#474"> 474: </a></span><span class="l"><a href="#475"> 475: </a></span><span class="l"><a href="#476"> 476: </a></span><span class="l"><a href="#477"> 477: </a></span><span class="l"><a href="#478"> 478: </a></span><span class="l"><a href="#479"> 479: </a></span><span class="l"><a href="#480"> 480: </a></span><span class="l"><a href="#481"> 481: </a></span><span class="l"><a href="#482"> 482: </a></span><span class="l"><a href="#483"> 483: </a></span><span class="l"><a href="#484"> 484: </a></span><span class="l"><a href="#485"> 485: </a></span><span class="l"><a href="#486"> 486: </a></span><span class="l"><a href="#487"> 487: </a></span><span class="l"><a href="#488"> 488: </a></span><span class="l"><a href="#489"> 489: </a></span><span class="l"><a href="#490"> 490: </a></span><span class="l"><a href="#491"> 491: </a></span><span class="l"><a href="#492"> 492: </a></span><span class="l"><a href="#493"> 493: </a></span><span class="l"><a href="#494"> 494: </a></span><span class="l"><a href="#495"> 495: </a></span><span class="l"><a href="#496"> 496: </a></span><span class="l"><a href="#497"> 497: </a></span><span class="l"><a href="#498"> 498: </a></span><span class="l"><a href="#499"> 499: </a></span><span class="l"><a href="#500"> 500: </a></span><span class="l"><a href="#501"> 501: </a></span><span class="l"><a href="#502"> 502: </a></span><span class="l"><a href="#503"> 503: </a></span><span class="l"><a href="#504"> 504: </a></span><span class="l"><a href="#505"> 505: </a></span><span class="l"><a href="#506"> 506: </a></span><span class="l"><a href="#507"> 507: </a></span><span class="l"><a href="#508"> 508: </a></span><span class="l"><a href="#509"> 509: </a></span><span class="l"><a href="#510"> 510: </a></span><span class="l"><a href="#511"> 511: </a></span><span class="l"><a href="#512"> 512: </a></span><span class="l"><a href="#513"> 513: </a></span><span class="l"><a href="#514"> 514: </a></span><span class="l"><a href="#515"> 515: </a></span><span class="l"><a href="#516"> 516: </a></span><span class="l"><a href="#517"> 517: </a></span><span class="l"><a href="#518"> 518: </a></span><span class="l"><a href="#519"> 519: </a></span><span class="l"><a href="#520"> 520: </a></span><span class="l"><a href="#521"> 521: </a></span><span class="l"><a href="#522"> 522: </a></span><span class="l"><a href="#523"> 523: </a></span><span class="l"><a href="#524"> 524: </a></span><span class="l"><a href="#525"> 525: </a></span><span class="l"><a href="#526"> 526: </a></span><span class="l"><a href="#527"> 527: </a></span><span class="l"><a href="#528"> 528: </a></span><span class="l"><a href="#529"> 529: </a></span><span class="l"><a href="#530"> 530: </a></span><span class="l"><a href="#531"> 531: </a></span><span class="l"><a href="#532"> 532: </a></span><span class="l"><a href="#533"> 533: </a></span><span class="l"><a href="#534"> 534: </a></span><span class="l"><a href="#535"> 535: </a></span><span class="l"><a href="#536"> 536: </a></span><span class="l"><a href="#537"> 537: </a></span><span class="l"><a href="#538"> 538: </a></span><span class="l"><a href="#539"> 539: </a></span><span class="l"><a href="#540"> 540: </a></span><span class="l"><a href="#541"> 541: </a></span><span class="l"><a href="#542"> 542: </a></span><span class="l"><a href="#543"> 543: </a></span><span class="l"><a href="#544"> 544: </a></span><span class="l"><a href="#545"> 545: </a></span><span class="l"><a href="#546"> 546: </a></span><span class="l"><a href="#547"> 547: </a></span><span class="l"><a href="#548"> 548: </a></span><span class="l"><a href="#549"> 549: </a></span><span class="l"><a href="#550"> 550: </a></span><span class="l"><a href="#551"> 551: </a></span><span class="l"><a href="#552"> 552: </a></span><span class="l"><a href="#553"> 553: </a></span><span class="l"><a href="#554"> 554: </a></span><span class="l"><a href="#555"> 555: </a></span><span class="l"><a href="#556"> 556: </a></span><span class="l"><a href="#557"> 557: </a></span><span class="l"><a href="#558"> 558: </a></span><span class="l"><a href="#559"> 559: </a></span><span class="l"><a href="#560"> 560: </a></span><span class="l"><a href="#561"> 561: </a></span><span class="l"><a href="#562"> 562: </a></span><span class="l"><a href="#563"> 563: </a></span><span class="l"><a href="#564"> 564: </a></span><span class="l"><a href="#565"> 565: </a></span><span class="l"><a href="#566"> 566: </a></span><span class="l"><a href="#567"> 567: </a></span><span class="l"><a href="#568"> 568: </a></span><span class="l"><a href="#569"> 569: </a></span><span class="l"><a href="#570"> 570: </a></span><span class="l"><a href="#571"> 571: </a></span><span class="l"><a href="#572"> 572: </a></span><span class="l"><a href="#573"> 573: </a></span><span class="l"><a href="#574"> 574: </a></span><span class="l"><a href="#575"> 575: </a></span><span class="l"><a href="#576"> 576: </a></span><span class="l"><a href="#577"> 577: </a></span><span class="l"><a href="#578"> 578: </a></span><span class="l"><a href="#579"> 579: </a></span><span class="l"><a href="#580"> 580: </a></span><span class="l"><a href="#581"> 581: </a></span><span class="l"><a href="#582"> 582: </a></span><span class="l"><a href="#583"> 583: </a></span><span class="l"><a href="#584"> 584: </a></span><span class="l"><a href="#585"> 585: </a></span><span class="l"><a href="#586"> 586: </a></span><span class="l"><a href="#587"> 587: </a></span><span class="l"><a href="#588"> 588: </a></span><span class="l"><a href="#589"> 589: </a></span><span class="l"><a href="#590"> 590: </a></span><span class="l"><a href="#591"> 591: </a></span><span class="l"><a href="#592"> 592: </a></span><span class="l"><a href="#593"> 593: </a></span><span class="l"><a href="#594"> 594: </a></span><span class="l"><a href="#595"> 595: </a></span><span class="l"><a href="#596"> 596: </a></span><span class="l"><a href="#597"> 597: </a></span><span class="l"><a href="#598"> 598: </a></span><span class="l"><a href="#599"> 599: </a></span><span class="l"><a href="#600"> 600: </a></span><span class="l"><a href="#601"> 601: </a></span><span class="l"><a href="#602"> 602: </a></span><span class="l"><a href="#603"> 603: </a></span><span class="l"><a href="#604"> 604: </a></span><span class="l"><a href="#605"> 605: </a></span><span class="l"><a href="#606"> 606: </a></span><span class="l"><a href="#607"> 607: </a></span><span class="l"><a href="#608"> 608: </a></span><span class="l"><a href="#609"> 609: </a></span><span class="l"><a href="#610"> 610: </a></span><span class="l"><a href="#611"> 611: </a></span><span class="l"><a href="#612"> 612: </a></span><span class="l"><a href="#613"> 613: </a></span><span class="l"><a href="#614"> 614: </a></span><span class="l"><a href="#615"> 615: </a></span><span class="l"><a href="#616"> 616: </a></span><span class="l"><a href="#617"> 617: </a></span><span class="l"><a href="#618"> 618: </a></span><span class="l"><a href="#619"> 619: </a></span><span class="l"><a href="#620"> 620: </a></span><span class="l"><a href="#621"> 621: </a></span><span class="l"><a href="#622"> 622: </a></span><span class="l"><a href="#623"> 623: </a></span><span class="l"><a href="#624"> 624: </a></span><span class="l"><a href="#625"> 625: </a></span><span class="l"><a href="#626"> 626: </a></span><span class="l"><a href="#627"> 627: </a></span><span class="l"><a href="#628"> 628: </a></span><span class="l"><a href="#629"> 629: </a></span><span class="l"><a href="#630"> 630: </a></span><span class="l"><a href="#631"> 631: </a></span><span class="l"><a href="#632"> 632: </a></span><span class="l"><a href="#633"> 633: </a></span><span class="l"><a href="#634"> 634: </a></span><span class="l"><a href="#635"> 635: </a></span><span class="l"><a href="#636"> 636: </a></span><span class="l"><a href="#637"> 637: </a></span><span class="l"><a href="#638"> 638: </a></span><span class="l"><a href="#639"> 639: </a></span><span class="l"><a href="#640"> 640: </a></span><span class="l"><a href="#641"> 641: </a></span><span class="l"><a href="#642"> 642: </a></span><span class="l"><a href="#643"> 643: </a></span><span class="l"><a href="#644"> 644: </a></span><span class="l"><a href="#645"> 645: </a></span><span class="l"><a href="#646"> 646: </a></span><span class="l"><a href="#647"> 647: </a></span><span class="l"><a href="#648"> 648: </a></span><span class="l"><a href="#649"> 649: </a></span><span class="l"><a href="#650"> 650: </a></span><span class="l"><a href="#651"> 651: </a></span><span class="l"><a href="#652"> 652: </a></span><span class="l"><a href="#653"> 653: </a></span><span class="l"><a href="#654"> 654: </a></span><span class="l"><a href="#655"> 655: </a></span><span class="l"><a href="#656"> 656: </a></span><span class="l"><a href="#657"> 657: </a></span><span class="l"><a href="#658"> 658: </a></span><span class="l"><a href="#659"> 659: </a></span><span class="l"><a href="#660"> 660: </a></span><span class="l"><a href="#661"> 661: </a></span><span class="l"><a href="#662"> 662: </a></span><span class="l"><a href="#663"> 663: </a></span><span class="l"><a href="#664"> 664: </a></span><span class="l"><a href="#665"> 665: </a></span><span class="l"><a href="#666"> 666: </a></span><span class="l"><a href="#667"> 667: </a></span><span class="l"><a href="#668"> 668: </a></span><span class="l"><a href="#669"> 669: </a></span><span class="l"><a href="#670"> 670: </a></span><span class="l"><a href="#671"> 671: </a></span><span class="l"><a href="#672"> 672: </a></span><span class="l"><a href="#673"> 673: </a></span><span class="l"><a href="#674"> 674: </a></span><span class="l"><a href="#675"> 675: </a></span><span class="l"><a href="#676"> 676: </a></span><span class="l"><a href="#677"> 677: </a></span><span class="l"><a href="#678"> 678: </a></span><span class="l"><a href="#679"> 679: </a></span><span class="l"><a href="#680"> 680: </a></span><span class="l"><a href="#681"> 681: </a></span><span class="l"><a href="#682"> 682: </a></span><span class="l"><a href="#683"> 683: </a></span><span class="l"><a href="#684"> 684: </a></span><span class="l"><a href="#685"> 685: </a></span><span class="l"><a href="#686"> 686: </a></span><span class="l"><a href="#687"> 687: </a></span><span class="l"><a href="#688"> 688: </a></span><span class="l"><a href="#689"> 689: </a></span><span class="l"><a href="#690"> 690: </a></span><span class="l"><a href="#691"> 691: </a></span><span class="l"><a href="#692"> 692: </a></span><span class="l"><a href="#693"> 693: </a></span><span class="l"><a href="#694"> 694: </a></span><span class="l"><a href="#695"> 695: </a></span><span class="l"><a href="#696"> 696: </a></span><span class="l"><a href="#697"> 697: </a></span><span class="l"><a href="#698"> 698: </a></span><span class="l"><a href="#699"> 699: </a></span><span class="l"><a href="#700"> 700: </a></span><span class="l"><a href="#701"> 701: </a></span><span class="l"><a href="#702"> 702: </a></span><span class="l"><a href="#703"> 703: </a></span><span class="l"><a href="#704"> 704: </a></span><span class="l"><a href="#705"> 705: </a></span><span class="l"><a href="#706"> 706: </a></span><span class="l"><a href="#707"> 707: </a></span><span class="l"><a href="#708"> 708: </a></span><span class="l"><a href="#709"> 709: </a></span><span class="l"><a href="#710"> 710: </a></span><span class="l"><a href="#711"> 711: </a></span><span class="l"><a href="#712"> 712: </a></span><span class="l"><a href="#713"> 713: </a></span><span class="l"><a href="#714"> 714: </a></span><span class="l"><a href="#715"> 715: </a></span><span class="l"><a href="#716"> 716: </a></span><span class="l"><a href="#717"> 717: </a></span><span class="l"><a href="#718"> 718: </a></span><span class="l"><a href="#719"> 719: </a></span><span class="l"><a href="#720"> 720: </a></span><span class="l"><a href="#721"> 721: </a></span><span class="l"><a href="#722"> 722: </a></span><span class="l"><a href="#723"> 723: </a></span><span class="l"><a href="#724"> 724: </a></span><span class="l"><a href="#725"> 725: </a></span><span class="l"><a href="#726"> 726: </a></span><span class="l"><a href="#727"> 727: </a></span><span class="l"><a href="#728"> 728: </a></span><span class="l"><a href="#729"> 729: </a></span><span class="l"><a href="#730"> 730: </a></span><span class="l"><a href="#731"> 731: </a></span><span class="l"><a href="#732"> 732: </a></span><span class="l"><a href="#733"> 733: </a></span><span class="l"><a href="#734"> 734: </a></span><span class="l"><a href="#735"> 735: </a></span><span class="l"><a href="#736"> 736: </a></span><span class="l"><a href="#737"> 737: </a></span><span class="l"><a href="#738"> 738: </a></span><span class="l"><a href="#739"> 739: </a></span><span class="l"><a href="#740"> 740: </a></span><span class="l"><a href="#741"> 741: </a></span><span class="l"><a href="#742"> 742: </a></span><span class="l"><a href="#743"> 743: </a></span><span class="l"><a href="#744"> 744: </a></span><span class="l"><a href="#745"> 745: </a></span><span class="l"><a href="#746"> 746: </a></span><span class="l"><a href="#747"> 747: </a></span><span class="l"><a href="#748"> 748: </a></span><span class="l"><a href="#749"> 749: </a></span><span class="l"><a href="#750"> 750: </a></span><span class="l"><a href="#751"> 751: </a></span><span class="l"><a href="#752"> 752: </a></span><span class="l"><a href="#753"> 753: </a></span><span class="l"><a href="#754"> 754: </a></span><span class="l"><a href="#755"> 755: </a></span><span class="l"><a href="#756"> 756: </a></span><span class="l"><a href="#757"> 757: </a></span><span class="l"><a href="#758"> 758: </a></span><span class="l"><a href="#759"> 759: </a></span><span class="l"><a href="#760"> 760: </a></span><span class="l"><a href="#761"> 761: </a></span><span class="l"><a href="#762"> 762: </a></span><span class="l"><a href="#763"> 763: </a></span><span class="l"><a href="#764"> 764: </a></span><span class="l"><a href="#765"> 765: </a></span><span class="l"><a href="#766"> 766: </a></span><span class="l"><a href="#767"> 767: </a></span><span class="l"><a href="#768"> 768: </a></span><span class="l"><a href="#769"> 769: </a></span><span class="l"><a href="#770"> 770: </a></span><span class="l"><a href="#771"> 771: </a></span><span class="l"><a href="#772"> 772: </a></span><span class="l"><a href="#773"> 773: </a></span><span class="l"><a href="#774"> 774: </a></span><span class="l"><a href="#775"> 775: </a></span><span class="l"><a href="#776"> 776: </a></span><span class="l"><a href="#777"> 777: </a></span><span class="l"><a href="#778"> 778: </a></span><span class="l"><a href="#779"> 779: </a></span><span class="l"><a href="#780"> 780: </a></span><span class="l"><a href="#781"> 781: </a></span><span class="l"><a href="#782"> 782: </a></span><span class="l"><a href="#783"> 783: </a></span><span class="l"><a href="#784"> 784: </a></span><span class="l"><a href="#785"> 785: </a></span><span class="l"><a href="#786"> 786: </a></span><span class="l"><a href="#787"> 787: </a></span><span class="l"><a href="#788"> 788: </a></span><span class="l"><a href="#789"> 789: </a></span><span class="l"><a href="#790"> 790: </a></span><span class="l"><a href="#791"> 791: </a></span><span class="l"><a href="#792"> 792: </a></span><span class="l"><a href="#793"> 793: </a></span><span class="l"><a href="#794"> 794: </a></span><span class="l"><a href="#795"> 795: </a></span><span class="l"><a href="#796"> 796: </a></span><span class="l"><a href="#797"> 797: </a></span><span class="l"><a href="#798"> 798: </a></span><span class="l"><a href="#799"> 799: </a></span><span class="l"><a href="#800"> 800: </a></span><span class="l"><a href="#801"> 801: </a></span><span class="l"><a href="#802"> 802: </a></span><span class="l"><a href="#803"> 803: </a></span><span class="l"><a href="#804"> 804: </a></span><span class="l"><a href="#805"> 805: </a></span><span class="l"><a href="#806"> 806: </a></span><span class="l"><a href="#807"> 807: </a></span><span class="l"><a href="#808"> 808: </a></span><span class="l"><a href="#809"> 809: </a></span><span class="l"><a href="#810"> 810: </a></span><span class="l"><a href="#811"> 811: </a></span><span class="l"><a href="#812"> 812: </a></span><span class="l"><a href="#813"> 813: </a></span><span class="l"><a href="#814"> 814: </a></span><span class="l"><a href="#815"> 815: </a></span><span class="l"><a href="#816"> 816: </a></span><span class="l"><a href="#817"> 817: </a></span><span class="l"><a href="#818"> 818: </a></span><span class="l"><a href="#819"> 819: </a></span><span class="l"><a href="#820"> 820: </a></span><span class="l"><a href="#821"> 821: </a></span><span class="l"><a href="#822"> 822: </a></span><span class="l"><a href="#823"> 823: </a></span><span class="l"><a href="#824"> 824: </a></span><span class="l"><a href="#825"> 825: </a></span><span class="l"><a href="#826"> 826: </a></span><span class="l"><a href="#827"> 827: </a></span><span class="l"><a href="#828"> 828: </a></span><span class="l"><a href="#829"> 829: </a></span><span class="l"><a href="#830"> 830: </a></span><span class="l"><a href="#831"> 831: </a></span><span class="l"><a href="#832"> 832: </a></span><span class="l"><a href="#833"> 833: </a></span><span class="l"><a href="#834"> 834: </a></span><span class="l"><a href="#835"> 835: </a></span><span class="l"><a href="#836"> 836: </a></span><span class="l"><a href="#837"> 837: </a></span><span class="l"><a href="#838"> 838: </a></span><span class="l"><a href="#839"> 839: </a></span><span class="l"><a href="#840"> 840: </a></span><span class="l"><a href="#841"> 841: </a></span><span class="l"><a href="#842"> 842: </a></span><span class="l"><a href="#843"> 843: </a></span><span class="l"><a href="#844"> 844: </a></span><span class="l"><a href="#845"> 845: </a></span><span class="l"><a href="#846"> 846: </a></span><span class="l"><a href="#847"> 847: </a></span><span class="l"><a href="#848"> 848: </a></span><span class="l"><a href="#849"> 849: </a></span><span class="l"><a href="#850"> 850: </a></span><span class="l"><a href="#851"> 851: </a></span><span class="l"><a href="#852"> 852: </a></span><span class="l"><a href="#853"> 853: </a></span><span class="l"><a href="#854"> 854: </a></span><span class="l"><a href="#855"> 855: </a></span><span class="l"><a href="#856"> 856: </a></span><span class="l"><a href="#857"> 857: </a></span><span class="l"><a href="#858"> 858: </a></span><span class="l"><a href="#859"> 859: </a></span><span class="l"><a href="#860"> 860: </a></span><span class="l"><a href="#861"> 861: </a></span><span class="l"><a href="#862"> 862: </a></span><span class="l"><a href="#863"> 863: </a></span><span class="l"><a href="#864"> 864: </a></span><span class="l"><a href="#865"> 865: </a></span><span class="l"><a href="#866"> 866: </a></span><span class="l"><a href="#867"> 867: </a></span><span class="l"><a href="#868"> 868: </a></span><span class="l"><a href="#869"> 869: </a></span><span class="l"><a href="#870"> 870: </a></span><span class="l"><a href="#871"> 871: </a></span><span class="l"><a href="#872"> 872: </a></span><span class="l"><a href="#873"> 873: </a></span><span class="l"><a href="#874"> 874: </a></span><span class="l"><a href="#875"> 875: </a></span><span class="l"><a href="#876"> 876: </a></span><span class="l"><a href="#877"> 877: </a></span><span class="l"><a href="#878"> 878: </a></span><span class="l"><a href="#879"> 879: </a></span><span class="l"><a href="#880"> 880: </a></span><span class="l"><a href="#881"> 881: </a></span><span class="l"><a href="#882"> 882: </a></span><span class="l"><a href="#883"> 883: </a></span><span class="l"><a href="#884"> 884: </a></span><span class="l"><a href="#885"> 885: </a></span><span class="l"><a href="#886"> 886: </a></span><span class="l"><a href="#887"> 887: </a></span><span class="l"><a href="#888"> 888: </a></span><span class="l"><a href="#889"> 889: </a></span><span class="l"><a href="#890"> 890: </a></span><span class="l"><a href="#891"> 891: </a></span><span class="l"><a href="#892"> 892: </a></span><span class="l"><a href="#893"> 893: </a></span><span class="l"><a href="#894"> 894: </a></span><span class="l"><a href="#895"> 895: </a></span><span class="l"><a href="#896"> 896: </a></span><span class="l"><a href="#897"> 897: </a></span><span class="l"><a href="#898"> 898: </a></span><span class="l"><a href="#899"> 899: </a></span><span class="l"><a href="#900"> 900: </a></span><span class="l"><a href="#901"> 901: </a></span><span class="l"><a href="#902"> 902: </a></span><span class="l"><a href="#903"> 903: </a></span><span class="l"><a href="#904"> 904: </a></span><span class="l"><a href="#905"> 905: </a></span><span class="l"><a href="#906"> 906: </a></span><span class="l"><a href="#907"> 907: </a></span><span class="l"><a href="#908"> 908: </a></span><span class="l"><a href="#909"> 909: </a></span><span class="l"><a href="#910"> 910: </a></span><span class="l"><a href="#911"> 911: </a></span><span class="l"><a href="#912"> 912: </a></span><span class="l"><a href="#913"> 913: </a></span><span class="l"><a href="#914"> 914: </a></span><span class="l"><a href="#915"> 915: </a></span><span class="l"><a href="#916"> 916: </a></span><span class="l"><a href="#917"> 917: </a></span><span class="l"><a href="#918"> 918: </a></span><span class="l"><a href="#919"> 919: </a></span><span class="l"><a href="#920"> 920: </a></span><span class="l"><a href="#921"> 921: </a></span><span class="l"><a href="#922"> 922: </a></span><span class="l"><a href="#923"> 923: </a></span><span class="l"><a href="#924"> 924: </a></span><span class="l"><a href="#925"> 925: </a></span><span class="l"><a href="#926"> 926: </a></span><span class="l"><a href="#927"> 927: </a></span><span class="l"><a href="#928"> 928: </a></span><span class="l"><a href="#929"> 929: </a></span><span class="l"><a href="#930"> 930: </a></span><span class="l"><a href="#931"> 931: </a></span><span class="l"><a href="#932"> 932: </a></span><span class="l"><a href="#933"> 933: </a></span><span class="l"><a href="#934"> 934: </a></span><span class="l"><a href="#935"> 935: </a></span><span class="l"><a href="#936"> 936: </a></span><span class="l"><a href="#937"> 937: </a></span><span class="l"><a href="#938"> 938: </a></span><span class="l"><a href="#939"> 939: </a></span><span class="l"><a href="#940"> 940: </a></span><span class="l"><a href="#941"> 941: </a></span><span class="l"><a href="#942"> 942: </a></span><span class="l"><a href="#943"> 943: </a></span><span class="l"><a href="#944"> 944: </a></span><span class="l"><a href="#945"> 945: </a></span><span class="l"><a href="#946"> 946: </a></span><span class="l"><a href="#947"> 947: </a></span><span class="l"><a href="#948"> 948: </a></span><span class="l"><a href="#949"> 949: </a></span><span class="l"><a href="#950"> 950: </a></span><span class="l"><a href="#951"> 951: </a></span><span class="l"><a href="#952"> 952: </a></span><span class="l"><a href="#953"> 953: </a></span><span class="l"><a href="#954"> 954: </a></span><span class="l"><a href="#955"> 955: </a></span><span class="l"><a href="#956"> 956: </a></span><span class="l"><a href="#957"> 957: </a></span><span class="l"><a href="#958"> 958: </a></span><span class="l"><a href="#959"> 959: </a></span><span class="l"><a href="#960"> 960: </a></span><span class="l"><a href="#961"> 961: </a></span><span class="l"><a href="#962"> 962: </a></span><span class="l"><a href="#963"> 963: </a></span><span class="l"><a href="#964"> 964: </a></span><span class="l"><a href="#965"> 965: </a></span><span class="l"><a href="#966"> 966: </a></span><span class="l"><a href="#967"> 967: </a></span><span class="l"><a href="#968"> 968: </a></span><span class="l"><a href="#969"> 969: </a></span><span class="l"><a href="#970"> 970: </a></span><span class="l"><a href="#971"> 971: </a></span><span class="l"><a href="#972"> 972: </a></span><span class="l"><a href="#973"> 973: </a></span><span class="l"><a href="#974"> 974: </a></span><span class="l"><a href="#975"> 975: </a></span><span class="l"><a href="#976"> 976: </a></span><span class="l"><a href="#977"> 977: </a></span><span class="l"><a href="#978"> 978: </a></span><span class="l"><a href="#979"> 979: </a></span><span class="l"><a href="#980"> 980: </a></span><span class="l"><a href="#981"> 981: </a></span><span class="l"><a href="#982"> 982: </a></span><span class="l"><a href="#983"> 983: </a></span><span class="l"><a href="#984"> 984: </a></span><span class="l"><a href="#985"> 985: </a></span><span class="l"><a href="#986"> 986: </a></span><span class="l"><a href="#987"> 987: </a></span><span class="l"><a href="#988"> 988: </a></span><span class="l"><a href="#989"> 989: </a></span><span class="l"><a href="#990"> 990: </a></span><span class="l"><a href="#991"> 991: </a></span><span class="l"><a href="#992"> 992: </a></span><span class="l"><a href="#993"> 993: </a></span><span class="l"><a href="#994"> 994: </a></span><span class="l"><a href="#995"> 995: </a></span><span class="l"><a href="#996"> 996: </a></span><span class="l"><a href="#997"> 997: </a></span><span class="l"><a href="#998"> 998: </a></span><span class="l"><a href="#999"> 999: </a></span><span class="l"><a href="#1000">1000: </a></span><span class="l"><a href="#1001">1001: </a></span><span class="l"><a href="#1002">1002: </a></span><span class="l"><a href="#1003">1003: </a></span><span class="l"><a href="#1004">1004: </a></span><span class="l"><a href="#1005">1005: </a></span><span class="l"><a href="#1006">1006: </a></span><span class="l"><a href="#1007">1007: </a></span><span class="l"><a href="#1008">1008: </a></span><span class="l"><a href="#1009">1009: </a></span></span><span class="l"><a href="#1010">1010: </a></span></span><span class="l"><a href="#1011">1011: </a></span></span><span class="l"><a href="#1012">1012: </a></span></span><span class="l"><a href="#1013">1013: </a></span></span><span class="l"><a href="#1014">1014: </a></span></span><span class="l"><a href="#1015">1015: </a></span></span><span class="l"><a href="#1016">1016: </a></span></span><span class="l"><a href="#1017">1017: </a></span></span><span class="l"><a href="#1018">1018: </a></span></span><span class="l"><a href="#1019">1019: </a></span></span><span class="l"><a href="#1020">1020: </a></span></span><span class="l"><a href="#1021">1021: </a></span></span><span class="l"><a href="#1022">1022: </a></span></span><span class="l"><a href="#1023">1023: </a></span></span><span class="l"><a href="#1024">1024: </a></span><span class="l"><a href="#1025">1025: </a></span><span class="l"><a href="#1026">1026: </a></span><span class="l"><a href="#1027">1027: </a></span><span class="l"><a href="#1028">1028: </a></span><span class="l"><a href="#1029">1029: </a></span><span class="l"><a href="#1030">1030: </a></span><span class="l"><a href="#1031">1031: </a></span><span class="l"><a href="#1032">1032: </a></span><span class="l"><a href="#1033">1033: </a></span><span class="l"><a href="#1034">1034: </a></span><span class="l"><a href="#1035">1035: </a></span><span class="l"><a href="#1036">1036: </a></span><span class="l"><a href="#1037">1037: </a></span><span class="l"><a href="#1038">1038: </a></span><span class="l"><a href="#1039">1039: </a></span><span class="l"><a href="#1040">1040: </a></span><span class="l"><a href="#1041">1041: </a></span><span class="l"><a href="#1042">1042: </a></span><span class="l"><a href="#1043">1043: </a></span><span class="l"><a href="#1044">1044: </a></span><span class="l"><a href="#1045">1045: </a></span><span class="l"><a href="#1046">1046: </a></span><span class="l"><a href="#1047">1047: </a></span><span class="l"><a href="#1048">1048: </a></span><span class="l"><a href="#1049">1049: </a></span><span class="l"><a href="#1050">1050: </a></span><span class="l"><a href="#1051">1051: </a></span><span class="l"><a href="#1052">1052: </a></span><span class="l"><a href="#1053">1053: </a></span><span class="l"><a href="#1054">1054: </a></span><span class="l"><a href="#1055">1055: </a></span></code></pre>
<pre class="code"><code><span id="1" class="l"><span class="xlang">&lt;?php</span>
</span><span id="2" class="l"><span class="php-comment">/**
</span></span><span id="3" class="l"><span class="php-comment"> * Class file for the Object_Sync_Sf_Salesforce_Push class.
</span></span><span id="4" class="l"><span class="php-comment"> *
</span></span><span id="5" class="l"><span class="php-comment"> * @file
</span></span><span id="6" class="l"><span class="php-comment"> */</span>
</span><span id="7" class="l">
</span><span id="8" class="l"><span class="php-keyword1">if</span> ( ! <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Salesforce'</span> ) ) {
</span><span id="9" class="l">    <span class="php-keyword1">die</span>();
</span><span id="10" class="l">}
</span><span id="11" class="l">
</span><span id="12" class="l"><span class="php-comment">/**
</span></span><span id="13" class="l"><span class="php-comment"> * Push data from WordPress into Salesforce
</span></span><span id="14" class="l"><span class="php-comment"> */</span>
</span><span id="15" class="l"><span class="php-keyword1">class</span> Object_Sync_Sf_Salesforce_Push {
</span><span id="16" class="l">
</span><span id="17" class="l">    <span class="php-keyword1">protected</span> <span class="php-var">$wpdb</span>;
</span><span id="18" class="l">    <span class="php-keyword1">protected</span> <span class="php-var">$version</span>;
</span><span id="19" class="l">    <span class="php-keyword1">protected</span> <span class="php-var">$login_credentials</span>;
</span><span id="20" class="l">    <span class="php-keyword1">protected</span> <span class="php-var">$slug</span>;
</span><span id="21" class="l">    <span class="php-keyword1">protected</span> <span class="php-var">$salesforce</span>;
</span><span id="22" class="l">    <span class="php-keyword1">protected</span> <span class="php-var">$mappings</span>;
</span><span id="23" class="l">    <span class="php-keyword1">protected</span> <span class="php-var">$logging</span>;
</span><span id="24" class="l">    <span class="php-keyword1">protected</span> <span class="php-var">$schedulable_classes</span>;
</span><span id="25" class="l">
</span><span id="26" class="l">    <span class="php-comment">/**
</span></span><span id="27" class="l"><span class="php-comment">    * @var string
</span></span><span id="28" class="l"><span class="php-comment">    */</span>
</span><span id="29" class="l">    <span class="php-keyword1">public</span> <span class="php-var">$schedule_name</span>; <span class="php-comment">// allow for naming the queue in case there are multiple queues</span>
</span><span id="30" class="l">
</span><span id="31" class="l">    <span class="php-comment">/**
</span></span><span id="32" class="l"><span class="php-comment">    * Constructor which sets up push schedule
</span></span><span id="33" class="l"><span class="php-comment">    *
</span></span><span id="34" class="l"><span class="php-comment">    * @param object $wpdb
</span></span><span id="35" class="l"><span class="php-comment">    * @param string $version
</span></span><span id="36" class="l"><span class="php-comment">    * @param array $login_credentials
</span></span><span id="37" class="l"><span class="php-comment">    * @param string $slug
</span></span><span id="38" class="l"><span class="php-comment">    * @param object $wordpress
</span></span><span id="39" class="l"><span class="php-comment">    * @param object $salesforce
</span></span><span id="40" class="l"><span class="php-comment">    * @param object $mappings
</span></span><span id="41" class="l"><span class="php-comment">    * @param object $logging
</span></span><span id="42" class="l"><span class="php-comment">    * @param array $schedulable_classes
</span></span><span id="43" class="l"><span class="php-comment">    * @throws \Object_Sync_Sf_Exception
</span></span><span id="44" class="l"><span class="php-comment">    */</span>
</span><span id="45" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> __construct( <span class="php-var">$wpdb</span>, <span class="php-var">$version</span>, <span class="php-var">$login_credentials</span>, <span class="php-var">$slug</span>, <span class="php-var">$wordpress</span>, <span class="php-var">$salesforce</span>, <span class="php-var">$mappings</span>, <span class="php-var">$logging</span>, <span class="php-var">$schedulable_classes</span> ) {
</span><span id="46" class="l">        <span class="php-var">$this</span>-&gt;wpdb                = <span class="php-var">$wpdb</span>;
</span><span id="47" class="l">        <span class="php-var">$this</span>-&gt;version             = <span class="php-var">$version</span>;
</span><span id="48" class="l">        <span class="php-var">$this</span>-&gt;login_credentials   = <span class="php-var">$login_credentials</span>;
</span><span id="49" class="l">        <span class="php-var">$this</span>-&gt;slug                = <span class="php-var">$slug</span>;
</span><span id="50" class="l">        <span class="php-var">$this</span>-&gt;wordpress           = <span class="php-var">$wordpress</span>;
</span><span id="51" class="l">        <span class="php-var">$this</span>-&gt;salesforce          = <span class="php-var">$salesforce</span>;
</span><span id="52" class="l">        <span class="php-var">$this</span>-&gt;mappings            = <span class="php-var">$mappings</span>;
</span><span id="53" class="l">        <span class="php-var">$this</span>-&gt;logging             = <span class="php-var">$logging</span>;
</span><span id="54" class="l">        <span class="php-var">$this</span>-&gt;schedulable_classes = <span class="php-var">$schedulable_classes</span>;
</span><span id="55" class="l">
</span><span id="56" class="l">        <span class="php-var">$this</span>-&gt;schedule_name = <span class="php-quote">'salesforce_push'</span>;
</span><span id="57" class="l">        <span class="php-var">$this</span>-&gt;schedule      = <span class="php-var">$this</span>-&gt;schedule();
</span><span id="58" class="l">        <span class="php-var">$this</span>-&gt;add_actions();
</span><span id="59" class="l">
</span><span id="60" class="l">        <span class="php-var">$this</span>-&gt;debug = get_option( <span class="php-quote">'object_sync_for_salesforce_debug_mode'</span>, <span class="php-keyword1">false</span> );
</span><span id="61" class="l">
</span><span id="62" class="l">    }
</span><span id="63" class="l">
</span><span id="64" class="l">    <span class="php-comment">/**
</span></span><span id="65" class="l"><span class="php-comment">    * Create the action hooks based on what object maps exist from the admin settings.
</span></span><span id="66" class="l"><span class="php-comment">    * We do not have any actions for blogroll at this time.
</span></span><span id="67" class="l"><span class="php-comment">    *
</span></span><span id="68" class="l"><span class="php-comment">    */</span>
</span><span id="69" class="l">    <span class="php-keyword1">private</span> <span class="php-keyword1">function</span> add_actions() {
</span><span id="70" class="l">        <span class="php-var">$db_version</span> = get_option( <span class="php-quote">'object_sync_for_salesforce_db_version'</span>, <span class="php-keyword1">false</span> );
</span><span id="71" class="l">        <span class="php-keyword1">if</span> ( <span class="php-var">$db_version</span> === <span class="php-var">$this</span>-&gt;version ) {
</span><span id="72" class="l">            <span class="php-keyword1">foreach</span> ( <span class="php-var">$this</span>-&gt;mappings-&gt;get_fieldmaps() <span class="php-keyword1">as</span> <span class="php-var">$mapping</span> ) {
</span><span id="73" class="l">                <span class="php-var">$object_type</span> = <span class="php-var">$mapping</span>[<span class="php-quote">'wordpress_object'</span>];
</span><span id="74" class="l">                <span class="php-keyword1">if</span> ( <span class="php-quote">'user'</span> === <span class="php-var">$object_type</span> ) {
</span><span id="75" class="l">                    add_action( <span class="php-quote">'user_register'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'add_user'</span> ), <span class="php-num">11</span>, <span class="php-num">1</span> );
</span><span id="76" class="l">                    add_action( <span class="php-quote">'profile_update'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'edit_user'</span> ), <span class="php-num">11</span>, <span class="php-num">2</span> );
</span><span id="77" class="l">                    add_action( <span class="php-quote">'delete_user'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'delete_user'</span> ) );
</span><span id="78" class="l">                } <span class="php-keyword1">elseif</span> ( <span class="php-quote">'post'</span> === <span class="php-var">$object_type</span> ) {
</span><span id="79" class="l">                    add_action( <span class="php-quote">'save_post'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'post_actions'</span> ), <span class="php-num">11</span>, <span class="php-num">2</span> );
</span><span id="80" class="l">                } <span class="php-keyword1">elseif</span> ( <span class="php-quote">'attachment'</span> === <span class="php-var">$object_type</span> ) {
</span><span id="81" class="l">                    add_action( <span class="php-quote">'add_attachment'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'add_attachment'</span> ) );
</span><span id="82" class="l">                    add_action( <span class="php-quote">'edit_attachment'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'edit_attachment'</span> ) );
</span><span id="83" class="l">                    add_action( <span class="php-quote">'delete_attachment'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'delete_attachment'</span> ) );
</span><span id="84" class="l">                } <span class="php-keyword1">elseif</span> ( <span class="php-quote">'category'</span> === <span class="php-var">$object_type</span> || <span class="php-quote">'tag'</span> === <span class="php-var">$object_type</span> || <span class="php-quote">'post_tag'</span> === <span class="php-var">$object_type</span> ) {
</span><span id="85" class="l">                    add_action( <span class="php-quote">'create_term'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'add_term'</span> ), <span class="php-num">11</span>, <span class="php-num">3</span> );
</span><span id="86" class="l">                    add_action( <span class="php-quote">'edit_terms'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'edit_term'</span> ), <span class="php-num">11</span>, <span class="php-num">2</span> );
</span><span id="87" class="l">                    add_action( <span class="php-quote">'delete_term'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'delete_term'</span> ), <span class="php-num">10</span>, <span class="php-num">4</span> );
</span><span id="88" class="l">                } <span class="php-keyword1">elseif</span> ( <span class="php-quote">'comment'</span> === <span class="php-var">$object_type</span> ) {
</span><span id="89" class="l">                    add_action( <span class="php-quote">'comment_post'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'add_comment'</span> ), <span class="php-num">11</span>, <span class="php-num">3</span> );
</span><span id="90" class="l">                    add_action( <span class="php-quote">'edit_comment'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'edit_comment'</span> ) );
</span><span id="91" class="l">                    add_action( <span class="php-quote">'delete_comment'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'delete_comment'</span> ) ); <span class="php-comment">// to be clear: this only runs when the comment gets deleted from the trash, either manually or automatically</span>
</span><span id="92" class="l">                } <span class="php-keyword1">else</span> { <span class="php-comment">// this is for custom post types</span>
</span><span id="93" class="l">                    <span class="php-comment">// we still have to use save_post because save_post_type fails to pull in the metadata</span>
</span><span id="94" class="l">                    add_action( <span class="php-quote">'save_post'</span>, <span class="php-keyword1">array</span>( <span class="php-var">$this</span>, <span class="php-quote">'post_actions'</span> ), <span class="php-num">11</span>, <span class="php-num">2</span> );
</span><span id="95" class="l">                }
</span><span id="96" class="l">            }
</span><span id="97" class="l">        }
</span><span id="98" class="l">    }
</span><span id="99" class="l">
</span><span id="100" class="l">    <span class="php-comment">/**
</span></span><span id="101" class="l"><span class="php-comment">    * Method for ajax hooks to call for pushing manually
</span></span><span id="102" class="l"><span class="php-comment">    *
</span></span><span id="103" class="l"><span class="php-comment">    * @param array $object
</span></span><span id="104" class="l"><span class="php-comment">    * @param string $type
</span></span><span id="105" class="l"><span class="php-comment">    *
</span></span><span id="106" class="l"><span class="php-comment">    */</span>
</span><span id="107" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> manual_object_update( <span class="php-var">$object</span>, <span class="php-var">$type</span> ) {
</span><span id="108" class="l">        <span class="php-var">$this</span>-&gt;salesforce_push_object_crud( <span class="php-var">$type</span>, <span class="php-var">$object</span>, <span class="php-var">$this</span>-&gt;mappings-&gt;sync_wordpress_update, <span class="php-keyword1">true</span> );
</span><span id="109" class="l">    }
</span><span id="110" class="l">
</span><span id="111" class="l">    <span class="php-comment">/**
</span></span><span id="112" class="l"><span class="php-comment">    * Callback method for adding a user
</span></span><span id="113" class="l"><span class="php-comment">    *
</span></span><span id="114" class="l"><span class="php-comment">    * @param string $user_id
</span></span><span id="115" class="l"><span class="php-comment">    */</span>
</span><span id="116" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> add_user( <span class="php-var">$user_id</span> ) {
</span><span id="117" class="l">        <span class="php-var">$user</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-quote">'user'</span>, <span class="php-var">$user_id</span> );
</span><span id="118" class="l">        <span class="php-var">$this</span>-&gt;object_insert( <span class="php-var">$user</span>, <span class="php-quote">'user'</span> );
</span><span id="119" class="l">    }
</span><span id="120" class="l">
</span><span id="121" class="l">    <span class="php-comment">/**
</span></span><span id="122" class="l"><span class="php-comment">    * Callback method for editing a user
</span></span><span id="123" class="l"><span class="php-comment">    *
</span></span><span id="124" class="l"><span class="php-comment">    * @param string $user_id
</span></span><span id="125" class="l"><span class="php-comment">    * @param object $old_user_data
</span></span><span id="126" class="l"><span class="php-comment">    */</span>
</span><span id="127" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> edit_user( <span class="php-var">$user_id</span>, <span class="php-var">$old_user_data</span> ) {
</span><span id="128" class="l">        <span class="php-var">$user</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-quote">'user'</span>, <span class="php-var">$user_id</span> );
</span><span id="129" class="l">        <span class="php-var">$this</span>-&gt;object_update( <span class="php-var">$user</span>, <span class="php-quote">'user'</span> );
</span><span id="130" class="l">    }
</span><span id="131" class="l">
</span><span id="132" class="l">    <span class="php-comment">/**
</span></span><span id="133" class="l"><span class="php-comment">    * Callback method for deleting a user
</span></span><span id="134" class="l"><span class="php-comment">    *
</span></span><span id="135" class="l"><span class="php-comment">    * @param string $user_id
</span></span><span id="136" class="l"><span class="php-comment">    */</span>
</span><span id="137" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> delete_user( <span class="php-var">$user_id</span> ) {
</span><span id="138" class="l">        <span class="php-var">$user</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-quote">'user'</span>, <span class="php-var">$user_id</span> );
</span><span id="139" class="l">        <span class="php-var">$this</span>-&gt;object_delete( <span class="php-var">$user</span>, <span class="php-quote">'user'</span> );
</span><span id="140" class="l">    }
</span><span id="141" class="l">
</span><span id="142" class="l">    <span class="php-comment">/**
</span></span><span id="143" class="l"><span class="php-comment">    * Callback method for posts of any type
</span></span><span id="144" class="l"><span class="php-comment">    * This can handle create, update, and delete actions
</span></span><span id="145" class="l"><span class="php-comment">    *
</span></span><span id="146" class="l"><span class="php-comment">    * @param string $post_id
</span></span><span id="147" class="l"><span class="php-comment">    * @param object $post
</span></span><span id="148" class="l"><span class="php-comment">    */</span>
</span><span id="149" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> post_actions( <span class="php-var">$post_id</span>, <span class="php-var">$post</span> ) {
</span><span id="150" class="l">
</span><span id="151" class="l">        <span class="php-var">$post_type</span> = <span class="php-var">$post</span>-&gt;post_type;
</span><span id="152" class="l">
</span><span id="153" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$post</span>-&gt;post_status ) &amp;&amp; <span class="php-quote">'auto-draft'</span> === <span class="php-var">$post</span>-&gt;post_status ) {
</span><span id="154" class="l">            <span class="php-keyword1">return</span>;
</span><span id="155" class="l">        }
</span><span id="156" class="l">        <span class="php-comment">// this plugin does not sync log or revision posts with salesforce</span>
</span><span id="157" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$post</span>-&gt;post_type ) &amp;&amp; <span class="php-keyword2">in_array</span>( <span class="php-var">$post</span>-&gt;post_type, <span class="php-keyword1">array</span>( <span class="php-quote">'wp_log'</span>, <span class="php-quote">'revision'</span> ), <span class="php-keyword1">true</span> ) ) {
</span><span id="158" class="l">            <span class="php-keyword1">return</span>;
</span><span id="159" class="l">        }
</span><span id="160" class="l">        <span class="php-keyword1">if</span> ( <span class="php-var">$post</span>-&gt;post_modified_gmt === <span class="php-var">$post</span>-&gt;post_date_gmt &amp;&amp; <span class="php-quote">'trash'</span> !== <span class="php-var">$post</span>-&gt;post_status ) {
</span><span id="161" class="l">            <span class="php-var">$update</span> = <span class="php-num">0</span>;
</span><span id="162" class="l">            <span class="php-var">$delete</span> = <span class="php-num">0</span>;
</span><span id="163" class="l">        } <span class="php-keyword1">elseif</span> ( <span class="php-quote">'trash'</span> !== <span class="php-var">$post</span>-&gt;post_status ) {
</span><span id="164" class="l">            <span class="php-var">$update</span> = <span class="php-num">1</span>;
</span><span id="165" class="l">            <span class="php-var">$delete</span> = <span class="php-num">0</span>;
</span><span id="166" class="l">        } <span class="php-keyword1">elseif</span> ( <span class="php-quote">'trash'</span> === <span class="php-var">$post</span>-&gt;post_status ) {
</span><span id="167" class="l">            <span class="php-var">$update</span> = <span class="php-num">0</span>;
</span><span id="168" class="l">            <span class="php-var">$delete</span> = <span class="php-num">1</span>;
</span><span id="169" class="l">        }
</span><span id="170" class="l">
</span><span id="171" class="l">        <span class="php-comment">// add support for woocommerce if it is installed</span>
</span><span id="172" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword2">defined</span>( <span class="php-quote">'WC_VERSION'</span> ) ) {
</span><span id="173" class="l">            <span class="php-comment">// statuses to ignore</span>
</span><span id="174" class="l">            <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$post</span>-&gt;post_status ) &amp;&amp; <span class="php-keyword2">in_array</span>( <span class="php-var">$post</span>-&gt;post_status, <span class="php-keyword1">array</span>( <span class="php-quote">'wc-pending'</span> ), <span class="php-keyword1">true</span> ) ) {
</span><span id="175" class="l">                <span class="php-keyword1">return</span>;
</span><span id="176" class="l">            }
</span><span id="177" class="l">            <span class="php-comment">// statuses to count as new. note that the api will also check to see if it already has been mapped before saving.</span>
</span><span id="178" class="l">            <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$post</span>-&gt;post_status ) &amp;&amp; <span class="php-keyword2">in_array</span>( <span class="php-var">$post</span>-&gt;post_status, <span class="php-keyword1">array</span>( <span class="php-quote">'wc-on-hold'</span>, <span class="php-quote">'wc-processing'</span> ), <span class="php-keyword1">true</span> ) ) {
</span><span id="179" class="l">                <span class="php-var">$update</span> = <span class="php-num">0</span>;
</span><span id="180" class="l">                <span class="php-var">$delete</span> = <span class="php-num">0</span>;
</span><span id="181" class="l">            }
</span><span id="182" class="l">        }
</span><span id="183" class="l">
</span><span id="184" class="l">        <span class="php-var">$post</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-var">$post</span>-&gt;post_type, <span class="php-var">$post_id</span> );
</span><span id="185" class="l">        <span class="php-keyword1">if</span> ( <span class="php-num">1</span> === <span class="php-var">$update</span> ) {
</span><span id="186" class="l">            <span class="php-var">$this</span>-&gt;object_update( <span class="php-var">$post</span>, <span class="php-var">$post_type</span> );
</span><span id="187" class="l">        } <span class="php-keyword1">elseif</span> ( <span class="php-num">1</span> === <span class="php-var">$delete</span> ) {
</span><span id="188" class="l">            <span class="php-var">$this</span>-&gt;object_delete( <span class="php-var">$post</span>, <span class="php-var">$post_type</span> );
</span><span id="189" class="l">        } <span class="php-keyword1">else</span> {
</span><span id="190" class="l">            <span class="php-var">$this</span>-&gt;object_insert( <span class="php-var">$post</span>, <span class="php-var">$post_type</span> );
</span><span id="191" class="l">        }
</span><span id="192" class="l">    }
</span><span id="193" class="l">
</span><span id="194" class="l">    <span class="php-comment">/**
</span></span><span id="195" class="l"><span class="php-comment">    * Callback method for adding an attachment
</span></span><span id="196" class="l"><span class="php-comment">    *
</span></span><span id="197" class="l"><span class="php-comment">    * @param string $post_id
</span></span><span id="198" class="l"><span class="php-comment">    */</span>
</span><span id="199" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> add_attachment( <span class="php-var">$post_id</span> ) {
</span><span id="200" class="l">        <span class="php-var">$attachment</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-quote">'attachment'</span>, <span class="php-var">$post_id</span> );
</span><span id="201" class="l">        <span class="php-var">$this</span>-&gt;object_insert( <span class="php-var">$attachment</span>, <span class="php-quote">'attachment'</span> );
</span><span id="202" class="l">    }
</span><span id="203" class="l">
</span><span id="204" class="l">    <span class="php-comment">/**
</span></span><span id="205" class="l"><span class="php-comment">    * Callback method for editing an attachment
</span></span><span id="206" class="l"><span class="php-comment">    *
</span></span><span id="207" class="l"><span class="php-comment">    * @param string $post_id
</span></span><span id="208" class="l"><span class="php-comment">    */</span>
</span><span id="209" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> edit_attachment( <span class="php-var">$post_id</span> ) {
</span><span id="210" class="l">        <span class="php-var">$attachment</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-quote">'attachment'</span>, <span class="php-var">$post_id</span> );
</span><span id="211" class="l">        <span class="php-var">$this</span>-&gt;object_update( <span class="php-var">$attachment</span>, <span class="php-quote">'attachment'</span> );
</span><span id="212" class="l">    }
</span><span id="213" class="l">
</span><span id="214" class="l">    <span class="php-comment">/**
</span></span><span id="215" class="l"><span class="php-comment">    * Callback method for editing an attachment
</span></span><span id="216" class="l"><span class="php-comment">    *
</span></span><span id="217" class="l"><span class="php-comment">    * @param string $post_id
</span></span><span id="218" class="l"><span class="php-comment">    */</span>
</span><span id="219" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> delete_attachment( <span class="php-var">$post_id</span> ) {
</span><span id="220" class="l">        <span class="php-var">$attachment</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-quote">'attachment'</span>, <span class="php-var">$post_id</span> );
</span><span id="221" class="l">        <span class="php-var">$this</span>-&gt;object_delete( <span class="php-var">$attachment</span>, <span class="php-quote">'attachment'</span> );
</span><span id="222" class="l">    }
</span><span id="223" class="l">
</span><span id="224" class="l">    <span class="php-comment">/**
</span></span><span id="225" class="l"><span class="php-comment">    * Callback method for adding a term
</span></span><span id="226" class="l"><span class="php-comment">    *
</span></span><span id="227" class="l"><span class="php-comment">    * @param string $term_id
</span></span><span id="228" class="l"><span class="php-comment">    * @param string $tt_id
</span></span><span id="229" class="l"><span class="php-comment">    * @param string $taxonomy
</span></span><span id="230" class="l"><span class="php-comment">    */</span>
</span><span id="231" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> add_term( <span class="php-var">$term_id</span>, <span class="php-var">$tt_id</span>, <span class="php-var">$taxonomy</span> ) {
</span><span id="232" class="l">        <span class="php-var">$term</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-var">$taxonomy</span>, <span class="php-var">$term_id</span> );
</span><span id="233" class="l">        <span class="php-var">$this</span>-&gt;object_insert( <span class="php-var">$term</span>, <span class="php-var">$taxonomy</span> );
</span><span id="234" class="l">    }
</span><span id="235" class="l">
</span><span id="236" class="l">    <span class="php-comment">/**
</span></span><span id="237" class="l"><span class="php-comment">    * Callback method for editing a term
</span></span><span id="238" class="l"><span class="php-comment">    *
</span></span><span id="239" class="l"><span class="php-comment">    * @param string $term_id
</span></span><span id="240" class="l"><span class="php-comment">    * @param string $taxonomy
</span></span><span id="241" class="l"><span class="php-comment">    */</span>
</span><span id="242" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> edit_term( <span class="php-var">$term_id</span>, <span class="php-var">$taxonomy</span> ) {
</span><span id="243" class="l">        <span class="php-var">$term</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-var">$taxonomy</span>, <span class="php-var">$term_id</span> );
</span><span id="244" class="l">        <span class="php-var">$this</span>-&gt;object_update( <span class="php-var">$term</span>, <span class="php-var">$taxonomy</span> );
</span><span id="245" class="l">    }
</span><span id="246" class="l">
</span><span id="247" class="l">    <span class="php-comment">/**
</span></span><span id="248" class="l"><span class="php-comment">    * Callback method for deleting a term
</span></span><span id="249" class="l"><span class="php-comment">    *
</span></span><span id="250" class="l"><span class="php-comment">    * @param int $term (id)
</span></span><span id="251" class="l"><span class="php-comment">    * @param int $term_taxonomy_id
</span></span><span id="252" class="l"><span class="php-comment">    * @param string $taxonomy (slug)
</span></span><span id="253" class="l"><span class="php-comment">    * @param object $deleted_term
</span></span><span id="254" class="l"><span class="php-comment">    */</span>
</span><span id="255" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> delete_term( <span class="php-var">$term</span>, <span class="php-var">$tt_id</span>, <span class="php-var">$taxonomy</span>, <span class="php-var">$deleted_term</span> ) {
</span><span id="256" class="l">        <span class="php-var">$deleted_term</span> = (<span class="php-keyword1">array</span>) <span class="php-var">$deleted_term</span>;
</span><span id="257" class="l">        <span class="php-var">$type</span>         = <span class="php-var">$deleted_term</span>[<span class="php-quote">'taxonomy'</span>];
</span><span id="258" class="l">        <span class="php-var">$this</span>-&gt;object_delete( <span class="php-var">$deleted_term</span>, <span class="php-var">$type</span> );
</span><span id="259" class="l">    }
</span><span id="260" class="l">
</span><span id="261" class="l">    <span class="php-comment">/**
</span></span><span id="262" class="l"><span class="php-comment">    * Callback method for adding a comment
</span></span><span id="263" class="l"><span class="php-comment">    *
</span></span><span id="264" class="l"><span class="php-comment">    * @param string $comment_id
</span></span><span id="265" class="l"><span class="php-comment">    * @param int|string comment_approved
</span></span><span id="266" class="l"><span class="php-comment">    * @param array $commentdata
</span></span><span id="267" class="l"><span class="php-comment">    */</span>
</span><span id="268" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> add_comment( <span class="php-var">$comment_id</span>, <span class="php-var">$comment_approved</span>, <span class="php-var">$commentdata</span> = <span class="php-keyword1">array</span>() ) {
</span><span id="269" class="l">        <span class="php-var">$comment</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-quote">'comment'</span>, <span class="php-var">$comment_id</span> );
</span><span id="270" class="l">        <span class="php-var">$this</span>-&gt;object_insert( <span class="php-var">$comment</span>, <span class="php-quote">'comment'</span> );
</span><span id="271" class="l">    }
</span><span id="272" class="l">
</span><span id="273" class="l">    <span class="php-comment">/**
</span></span><span id="274" class="l"><span class="php-comment">    * Callback method for editing a comment
</span></span><span id="275" class="l"><span class="php-comment">    *
</span></span><span id="276" class="l"><span class="php-comment">    * @param string $comment_id
</span></span><span id="277" class="l"><span class="php-comment">    */</span>
</span><span id="278" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> edit_comment( <span class="php-var">$comment_id</span> ) {
</span><span id="279" class="l">        <span class="php-var">$comment</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-quote">'comment'</span>, <span class="php-var">$comment_id</span> );
</span><span id="280" class="l">        <span class="php-var">$this</span>-&gt;object_update( <span class="php-var">$comment</span>, <span class="php-quote">'comment'</span> );
</span><span id="281" class="l">    }
</span><span id="282" class="l">
</span><span id="283" class="l">    <span class="php-comment">/**
</span></span><span id="284" class="l"><span class="php-comment">    * Callback method for deleting a comment
</span></span><span id="285" class="l"><span class="php-comment">    *
</span></span><span id="286" class="l"><span class="php-comment">    * @param string $comment_id
</span></span><span id="287" class="l"><span class="php-comment">    */</span>
</span><span id="288" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> delete_comment( <span class="php-var">$comment_id</span> ) {
</span><span id="289" class="l">        <span class="php-var">$comment</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_object_data( <span class="php-quote">'comment'</span>, <span class="php-var">$comment_id</span> );
</span><span id="290" class="l">        <span class="php-var">$this</span>-&gt;object_delete( <span class="php-var">$comment</span>, <span class="php-quote">'comment'</span> );
</span><span id="291" class="l">    }
</span><span id="292" class="l">
</span><span id="293" class="l">    <span class="php-comment">/**
</span></span><span id="294" class="l"><span class="php-comment">    * Insert a new object
</span></span><span id="295" class="l"><span class="php-comment">    * This calls the overall push crud method, which controls queuing and sending data to the Salesforce class
</span></span><span id="296" class="l"><span class="php-comment">    */</span>
</span><span id="297" class="l">    <span class="php-keyword1">private</span> <span class="php-keyword1">function</span> object_insert( <span class="php-var">$object</span>, <span class="php-var">$type</span> ) {
</span><span id="298" class="l">        <span class="php-var">$this</span>-&gt;salesforce_push_object_crud( <span class="php-var">$type</span>, <span class="php-var">$object</span>, <span class="php-var">$this</span>-&gt;mappings-&gt;sync_wordpress_create );
</span><span id="299" class="l">    }
</span><span id="300" class="l">
</span><span id="301" class="l">    <span class="php-comment">/**
</span></span><span id="302" class="l"><span class="php-comment">    * Update an existing object
</span></span><span id="303" class="l"><span class="php-comment">    * This calls the overall push crud method, which controls queuing and sending data to the Salesforce class
</span></span><span id="304" class="l"><span class="php-comment">    */</span>
</span><span id="305" class="l">    <span class="php-keyword1">private</span> <span class="php-keyword1">function</span> object_update( <span class="php-var">$object</span>, <span class="php-var">$type</span> ) {
</span><span id="306" class="l">        <span class="php-var">$this</span>-&gt;salesforce_push_object_crud( <span class="php-var">$type</span>, <span class="php-var">$object</span>, <span class="php-var">$this</span>-&gt;mappings-&gt;sync_wordpress_update );
</span><span id="307" class="l">    }
</span><span id="308" class="l">
</span><span id="309" class="l">    <span class="php-comment">/**
</span></span><span id="310" class="l"><span class="php-comment">    * Delete an existing object
</span></span><span id="311" class="l"><span class="php-comment">    * This calls the overall push crud method, which controls queuing and sending data to the Salesforce class
</span></span><span id="312" class="l"><span class="php-comment">    */</span>
</span><span id="313" class="l">    <span class="php-keyword1">private</span> <span class="php-keyword1">function</span> object_delete( <span class="php-var">$object</span>, <span class="php-var">$type</span> ) {
</span><span id="314" class="l">        <span class="php-var">$this</span>-&gt;salesforce_push_object_crud( <span class="php-var">$type</span>, <span class="php-var">$object</span>, <span class="php-var">$this</span>-&gt;mappings-&gt;sync_wordpress_delete );
</span><span id="315" class="l">    }
</span><span id="316" class="l">
</span><span id="317" class="l">    <span class="php-comment">/**
</span></span><span id="318" class="l"><span class="php-comment">    * Push objects to Salesforce.
</span></span><span id="319" class="l"><span class="php-comment">    * This method decides whether to do the processing immediately or queue it to the schedule class (or skip it based on another plugin's activity)
</span></span><span id="320" class="l"><span class="php-comment">    *
</span></span><span id="321" class="l"><span class="php-comment">    * @param string $object_type
</span></span><span id="322" class="l"><span class="php-comment">    *   Type of WordPress object.
</span></span><span id="323" class="l"><span class="php-comment">    * @param array $object
</span></span><span id="324" class="l"><span class="php-comment">    *   The WordPress data that needs to be sent to Salesforce.
</span></span><span id="325" class="l"><span class="php-comment">    * @param int $sf_sync_trigger
</span></span><span id="326" class="l"><span class="php-comment">    *   The trigger being responded to.
</span></span><span id="327" class="l"><span class="php-comment">    * @param bool $manual
</span></span><span id="328" class="l"><span class="php-comment">    *   Are we calling this manually?
</span></span><span id="329" class="l"><span class="php-comment">    *
</span></span><span id="330" class="l"><span class="php-comment">    */</span>
</span><span id="331" class="l">    <span class="php-keyword1">private</span> <span class="php-keyword1">function</span> salesforce_push_object_crud( <span class="php-var">$object_type</span>, <span class="php-var">$object</span>, <span class="php-var">$sf_sync_trigger</span>, <span class="php-var">$manual</span> = <span class="php-keyword1">false</span> ) {
</span><span id="332" class="l">
</span><span id="333" class="l">        <span class="php-var">$structure</span>       = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_table_structure( <span class="php-var">$object_type</span> );
</span><span id="334" class="l">        <span class="php-var">$object_id_field</span> = <span class="php-var">$structure</span>[<span class="php-quote">'id_field'</span>];
</span><span id="335" class="l">
</span><span id="336" class="l">        <span class="php-comment">// there is a WordPress object to push</span>
</span><span id="337" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$object</span>[ <span class="php-var">$object_id_field</span> ] ) ) {
</span><span id="338" class="l">            <span class="php-var">$mapping_object</span> = <span class="php-var">$this</span>-&gt;mappings-&gt;load_by_wordpress( <span class="php-var">$object_type</span>, <span class="php-var">$object</span>[ <span class="php-var">$object_id_field</span> ] );
</span><span id="339" class="l">
</span><span id="340" class="l">            <span class="php-comment">// there is already a mapping object for this WordPress object</span>
</span><span id="341" class="l">            <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$mapping_object</span>[<span class="php-quote">'id'</span>] ) ) {
</span><span id="342" class="l">                <span class="php-var">$mapping_object_id_transient</span> = <span class="php-var">$mapping_object</span>[<span class="php-quote">'id'</span>];
</span><span id="343" class="l">            } <span class="php-keyword1">else</span> {
</span><span id="344" class="l">                <span class="php-comment">// there is not a mapping object for this WordPress object id yet</span>
</span><span id="345" class="l">                <span class="php-comment">// check for that transient with the currently pulling id</span>
</span><span id="346" class="l">                <span class="php-var">$mapping_object_id_transient</span> = (int) get_transient( <span class="php-quote">'salesforce_pulling_object_id'</span> );
</span><span id="347" class="l">            }
</span><span id="348" class="l">
</span><span id="349" class="l">            <span class="php-var">$salesforce_pulling</span> = (int) get_transient( <span class="php-quote">'salesforce_pulling_'</span> . <span class="php-var">$mapping_object_id_transient</span> );
</span><span id="350" class="l">            <span class="php-keyword1">if</span> ( <span class="php-num">1</span> === <span class="php-var">$salesforce_pulling</span> ) {
</span><span id="351" class="l">                delete_transient( <span class="php-quote">'salesforce_pulling_'</span> . <span class="php-var">$mapping_object_id_transient</span> );
</span><span id="352" class="l">                <span class="php-var">$pulling_id</span> = get_transient( <span class="php-quote">'salesforce_pulling_object_id'</span> );
</span><span id="353" class="l">                <span class="php-keyword1">if</span> ( <span class="php-var">$pulling_id</span> === <span class="php-var">$mapping_object_id_transient</span> ) {
</span><span id="354" class="l">                    delete_transient( <span class="php-quote">'salesforce_pulling_object_id'</span> );
</span><span id="355" class="l">                }
</span><span id="356" class="l">                <span class="php-keyword1">return</span> <span class="php-keyword1">false</span>;
</span><span id="357" class="l">            }
</span><span id="358" class="l">        } <span class="php-keyword1">else</span> {
</span><span id="359" class="l">            <span class="php-comment">// if we don't have a WordPress object id, we've got no business doing stuff in Salesforce</span>
</span><span id="360" class="l">            <span class="php-var">$status</span> = <span class="php-quote">'error'</span>;
</span><span id="361" class="l">            <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$this</span>-&gt;logging ) ) {
</span><span id="362" class="l">                <span class="php-var">$logging</span> = <span class="php-var">$this</span>-&gt;logging;
</span><span id="363" class="l">            } <span class="php-keyword1">elseif</span> ( <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Logging'</span> ) ) {
</span><span id="364" class="l">                <span class="php-var">$logging</span> = <span class="php-keyword1">new</span> Object_Sync_Sf_Logging( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version );
</span><span id="365" class="l">            }
</span><span id="366" class="l">
</span><span id="367" class="l">            <span class="php-comment">// translators: placeholder is the name of the WordPress id field</span>
</span><span id="368" class="l">            <span class="php-var">$title</span> = <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'Error: Salesforce Push: unable to process queue item because it has no WordPress %1$s.'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ),
</span><span id="369" class="l">                esc_attr( <span class="php-var">$object_id_field</span> )
</span><span id="370" class="l">            );
</span><span id="371" class="l">
</span><span id="372" class="l">            <span class="php-var">$logging</span>-&gt;setup(
</span><span id="373" class="l">                <span class="php-var">$title</span>,
</span><span id="374" class="l">                <span class="php-keyword2">print_r</span>( <span class="php-var">$object</span>, <span class="php-keyword1">true</span> ), <span class="php-comment">// print this array because if this happens, something weird has happened and we want to log whatever we have</span>
</span><span id="375" class="l">                <span class="php-var">$sf_sync_trigger</span>,
</span><span id="376" class="l">                <span class="php-num">0</span>, <span class="php-comment">// parent id goes here but we don't have one, so make it 0</span>
</span><span id="377" class="l">                <span class="php-var">$status</span>
</span><span id="378" class="l">            );
</span><span id="379" class="l">            <span class="php-keyword1">return</span>;
</span><span id="380" class="l">        } <span class="php-comment">// End if().</span>
</span><span id="381" class="l">
</span><span id="382" class="l">        <span class="php-comment">// load mappings that match this criteria</span>
</span><span id="383" class="l">        <span class="php-comment">// in this case, it's all mappings that correspond to the posted WordPress object</span>
</span><span id="384" class="l">        <span class="php-var">$sf_mappings</span> = <span class="php-var">$this</span>-&gt;mappings-&gt;get_fieldmaps(
</span><span id="385" class="l">            <span class="php-keyword1">null</span>, <span class="php-comment">// id field must be null for multiples</span>
</span><span id="386" class="l">            <span class="php-keyword1">array</span>(
</span><span id="387" class="l">                <span class="php-quote">'wordpress_object'</span> =&gt; <span class="php-var">$object_type</span>,
</span><span id="388" class="l">            )
</span><span id="389" class="l">        );
</span><span id="390" class="l">
</span><span id="391" class="l">        <span class="php-keyword1">foreach</span> ( <span class="php-var">$sf_mappings</span> <span class="php-keyword1">as</span> <span class="php-var">$mapping</span> ) { <span class="php-comment">// for each mapping of this object</span>
</span><span id="392" class="l">            <span class="php-var">$map_sync_triggers</span> = <span class="php-var">$mapping</span>[<span class="php-quote">'sync_triggers'</span>];
</span><span id="393" class="l">
</span><span id="394" class="l">            <span class="php-comment">// these are bit operators, so we leave out the strict</span>
</span><span id="395" class="l">            <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$map_sync_triggers</span> ) &amp;&amp; <span class="php-keyword1">isset</span>( <span class="php-var">$sf_sync_trigger</span> ) &amp;&amp; <span class="php-keyword2">in_array</span>( <span class="php-var">$sf_sync_trigger</span>, <span class="php-var">$map_sync_triggers</span> ) ) { <span class="php-comment">// wp or sf crud event</span>
</span><span id="396" class="l">
</span><span id="397" class="l">                <span class="php-comment">// hook to allow other plugins to prevent a push per-mapping.</span>
</span><span id="398" class="l">                <span class="php-var">$push_allowed</span> = apply_filters( <span class="php-quote">'object_sync_for_salesforce_push_object_allowed'</span>, <span class="php-keyword1">true</span>, <span class="php-var">$object_type</span>, <span class="php-var">$object</span>, <span class="php-var">$sf_sync_trigger</span>, <span class="php-var">$mapping</span> );
</span><span id="399" class="l">
</span><span id="400" class="l">                <span class="php-comment">// example to keep from pushing the user with id of 1</span>
</span><span id="401" class="l">                <span class="php-comment">/*
</span></span><span id="402" class="l"><span class="php-comment">                add_filter( 'object_sync_for_salesforce_push_object_allowed', 'check_user', 10, 5 );
</span></span><span id="403" class="l"><span class="php-comment">                // can always reduce this number if all the arguments are not necessary
</span></span><span id="404" class="l"><span class="php-comment">                function check_user( $push_allowed, $object_type, $object, $sf_sync_trigger, $mapping ) {
</span></span><span id="405" class="l"><span class="php-comment">                    if ( $object_type === 'user' &amp;&amp; $object['Id'] === 1 ) {
</span></span><span id="406" class="l"><span class="php-comment">                        return FALSE;
</span></span><span id="407" class="l"><span class="php-comment">                    }
</span></span><span id="408" class="l"><span class="php-comment">                }
</span></span><span id="409" class="l"><span class="php-comment">                */</span>
</span><span id="410" class="l">
</span><span id="411" class="l">                <span class="php-keyword1">if</span> ( <span class="php-keyword1">false</span> === <span class="php-var">$push_allowed</span> ) {
</span><span id="412" class="l">                    <span class="php-keyword1">continue</span>;
</span><span id="413" class="l">                }
</span><span id="414" class="l">
</span><span id="415" class="l">                <span class="php-comment">// push drafts if the setting says so</span>
</span><span id="416" class="l">                <span class="php-comment">// post status is draft, or post status is inherit and post type is not attachment</span>
</span><span id="417" class="l">                <span class="php-keyword1">if</span> ( ( ! <span class="php-keyword1">isset</span>( <span class="php-var">$mapping</span>[<span class="php-quote">'push_drafts'</span>] ) || <span class="php-quote">'1'</span> !== <span class="php-var">$mapping</span>[<span class="php-quote">'push_drafts'</span>] ) &amp;&amp; <span class="php-keyword1">isset</span>( <span class="php-var">$object</span>[<span class="php-quote">'post_status'</span>] ) &amp;&amp; ( <span class="php-quote">'draft'</span> === <span class="php-var">$object</span>[<span class="php-quote">'post_status'</span>] || ( <span class="php-quote">'inherit'</span> === <span class="php-var">$object</span>[<span class="php-quote">'post_status'</span>] &amp;&amp; <span class="php-quote">'attachment'</span> !== <span class="php-var">$object</span>[<span class="php-quote">'post_type'</span>] ) ) ) {
</span><span id="418" class="l">                    <span class="php-comment">// skip this object if it is a draft and the fieldmap settings told us to ignore it</span>
</span><span id="419" class="l">                    <span class="php-keyword1">continue</span>;
</span><span id="420" class="l">                }
</span><span id="421" class="l">                <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$mapping</span>[<span class="php-quote">'push_async'</span>] ) &amp;&amp; ( <span class="php-quote">'1'</span> === <span class="php-var">$mapping</span>[<span class="php-quote">'push_async'</span>] ) &amp;&amp; <span class="php-keyword1">false</span> === <span class="php-var">$manual</span> ) {
</span><span id="422" class="l">                    <span class="php-comment">// this item is async and we want to save it to the queue</span>
</span><span id="423" class="l">                    <span class="php-var">$data</span> = <span class="php-keyword1">array</span>(
</span><span id="424" class="l">                        <span class="php-quote">'object_type'</span>     =&gt; <span class="php-var">$object_type</span>,
</span><span id="425" class="l">                        <span class="php-quote">'object'</span>          =&gt; <span class="php-var">$object</span>,
</span><span id="426" class="l">                        <span class="php-quote">'mapping'</span>         =&gt; <span class="php-var">$mapping</span>,
</span><span id="427" class="l">                        <span class="php-quote">'sf_sync_trigger'</span> =&gt; <span class="php-var">$sf_sync_trigger</span>,
</span><span id="428" class="l">                    );
</span><span id="429" class="l">
</span><span id="430" class="l">                    <span class="php-comment">// create new schedule based on the options for this current class</span>
</span><span id="431" class="l">                    <span class="php-comment">// this will use the existing schedule if it already exists; otherwise it'll create one</span>
</span><span id="432" class="l">                    <span class="php-var">$this</span>-&gt;schedule-&gt;use_schedule( <span class="php-var">$this</span>-&gt;schedule_name );
</span><span id="433" class="l">                    <span class="php-var">$this</span>-&gt;schedule-&gt;push_to_queue( <span class="php-var">$data</span> );
</span><span id="434" class="l">                    <span class="php-var">$this</span>-&gt;schedule-&gt;save()-&gt;dispatch();
</span><span id="435" class="l">
</span><span id="436" class="l">                } <span class="php-keyword1">else</span> {
</span><span id="437" class="l">                    <span class="php-comment">// this one is not async. do it immediately.</span>
</span><span id="438" class="l">                    <span class="php-var">$push</span> = <span class="php-var">$this</span>-&gt;salesforce_push_sync_rest( <span class="php-var">$object_type</span>, <span class="php-var">$object</span>, <span class="php-var">$mapping</span>, <span class="php-var">$sf_sync_trigger</span> );
</span><span id="439" class="l">                } <span class="php-comment">// End if().</span>
</span><span id="440" class="l">            } <span class="php-comment">// End if(). if the trigger does not match our requirements, skip it</span>
</span><span id="441" class="l">        } <span class="php-comment">// End foreach().</span>
</span><span id="442" class="l">    }
</span><span id="443" class="l">
</span><span id="444" class="l">    <span class="php-keyword1">private</span> <span class="php-keyword1">function</span> schedule() {
</span><span id="445" class="l">        <span class="php-keyword1">if</span> ( ! <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Schedule'</span> ) &amp;&amp; <span class="php-keyword2">file_exists</span>( plugin_dir_path( __FILE__ ) . <span class="php-quote">'../vendor/autoload.php'</span> ) ) {
</span><span id="446" class="l">            <span class="php-keyword1">require_once</span> plugin_dir_path( __FILE__ ) . <span class="php-quote">'../vendor/autoload.php'</span>;
</span><span id="447" class="l">            <span class="php-keyword1">require_once</span> plugin_dir_path( __FILE__ ) . <span class="php-quote">'../classes/schedule.php'</span>;
</span><span id="448" class="l">        }
</span><span id="449" class="l">        <span class="php-var">$schedule</span>       = <span class="php-keyword1">new</span> Object_Sync_Sf_Schedule( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version, <span class="php-var">$this</span>-&gt;login_credentials, <span class="php-var">$this</span>-&gt;slug, <span class="php-var">$this</span>-&gt;wordpress, <span class="php-var">$this</span>-&gt;salesforce, <span class="php-var">$this</span>-&gt;mappings, <span class="php-var">$this</span>-&gt;schedule_name, <span class="php-var">$this</span>-&gt;logging, <span class="php-var">$this</span>-&gt;schedulable_classes );
</span><span id="450" class="l">        <span class="php-var">$this</span>-&gt;schedule = <span class="php-var">$schedule</span>;
</span><span id="451" class="l">        <span class="php-keyword1">return</span> <span class="php-var">$schedule</span>;
</span><span id="452" class="l">    }
</span><span id="453" class="l">
</span><span id="454" class="l">    <span class="php-comment">/**
</span></span><span id="455" class="l"><span class="php-comment">    * Sync WordPress objects and Salesforce objects using the REST API.
</span></span><span id="456" class="l"><span class="php-comment">    *
</span></span><span id="457" class="l"><span class="php-comment">    * @param string $object_type
</span></span><span id="458" class="l"><span class="php-comment">    *   Type of WordPress object.
</span></span><span id="459" class="l"><span class="php-comment">    * @param object $object
</span></span><span id="460" class="l"><span class="php-comment">    *   The object object.
</span></span><span id="461" class="l"><span class="php-comment">    * @param object $mapping
</span></span><span id="462" class="l"><span class="php-comment">    *   Salesforce mapping object.
</span></span><span id="463" class="l"><span class="php-comment">    * @param int $sf_sync_trigger
</span></span><span id="464" class="l"><span class="php-comment">    *   Trigger for this sync.
</span></span><span id="465" class="l"><span class="php-comment">    *
</span></span><span id="466" class="l"><span class="php-comment">    * @return true or exit the method
</span></span><span id="467" class="l"><span class="php-comment">    *
</span></span><span id="468" class="l"><span class="php-comment">    */</span>
</span><span id="469" class="l">    <span class="php-keyword1">public</span> <span class="php-keyword1">function</span> salesforce_push_sync_rest( <span class="php-var">$object_type</span>, <span class="php-var">$object</span>, <span class="php-var">$mapping</span>, <span class="php-var">$sf_sync_trigger</span> ) {
</span><span id="470" class="l">
</span><span id="471" class="l">        <span class="php-comment">// If Salesforce is not authorized, don't do anything.</span>
</span><span id="472" class="l">        <span class="php-comment">// it's unclear to me if we need to do something else here or if this is sufficient. This is all Drupal does.</span>
</span><span id="473" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword1">true</span> !== <span class="php-var">$this</span>-&gt;salesforce[<span class="php-quote">'is_authorized'</span>] ) {
</span><span id="474" class="l">            <span class="php-keyword1">return</span>;
</span><span id="475" class="l">        }
</span><span id="476" class="l">
</span><span id="477" class="l">        <span class="php-var">$sfapi</span> = <span class="php-var">$this</span>-&gt;salesforce[<span class="php-quote">'sfapi'</span>];
</span><span id="478" class="l">
</span><span id="479" class="l">        <span class="php-comment">// we need to get the WordPress id here so we can check to see if the object already has a map</span>
</span><span id="480" class="l">        <span class="php-var">$structure</span> = <span class="php-var">$this</span>-&gt;wordpress-&gt;get_wordpress_table_structure( <span class="php-var">$object_type</span> );
</span><span id="481" class="l">        <span class="php-var">$object_id</span> = <span class="php-var">$structure</span>[<span class="php-quote">'id_field'</span>];
</span><span id="482" class="l">
</span><span id="483" class="l">        <span class="php-comment">// this returns the row that maps the individual WordPress row to the individual Salesfoce row</span>
</span><span id="484" class="l">        <span class="php-var">$mapping_object</span> = <span class="php-var">$this</span>-&gt;mappings-&gt;load_by_wordpress( <span class="php-var">$object_type</span>, <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ] );
</span><span id="485" class="l">
</span><span id="486" class="l">        <span class="php-comment">// hook to allow other plugins to define or alter the mapping object</span>
</span><span id="487" class="l">        <span class="php-var">$mapping_object</span> = apply_filters( <span class="php-quote">'object_sync_for_salesforce_push_mapping_object'</span>, <span class="php-var">$mapping_object</span>, <span class="php-var">$object</span>, <span class="php-var">$mapping</span> );
</span><span id="488" class="l">
</span><span id="489" class="l">        <span class="php-comment">// we already have the data from WordPress at this point; we just need to work with it in Salesforce</span>
</span><span id="490" class="l">        <span class="php-var">$synced_object</span> = <span class="php-keyword1">array</span>(
</span><span id="491" class="l">            <span class="php-quote">'wordpress_object'</span> =&gt; <span class="php-var">$object</span>,
</span><span id="492" class="l">            <span class="php-quote">'mapping_object'</span>   =&gt; <span class="php-var">$mapping_object</span>,
</span><span id="493" class="l">            <span class="php-quote">'queue_item'</span>       =&gt; <span class="php-keyword1">false</span>,
</span><span id="494" class="l">            <span class="php-quote">'mapping'</span>          =&gt; <span class="php-var">$mapping</span>,
</span><span id="495" class="l">        );
</span><span id="496" class="l">
</span><span id="497" class="l">        <span class="php-var">$op</span> = <span class="php-quote">''</span>;
</span><span id="498" class="l">
</span><span id="499" class="l">        <span class="php-comment">// deleting mapped objects</span>
</span><span id="500" class="l">        <span class="php-comment">// these are bit operators, so we leave out the strict</span>
</span><span id="501" class="l">        <span class="php-keyword1">if</span> ( <span class="php-var">$sf_sync_trigger</span> == <span class="php-var">$this</span>-&gt;mappings-&gt;sync_wordpress_delete ) {
</span><span id="502" class="l">            <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$mapping_object</span>[<span class="php-quote">'id'</span>] ) ) {
</span><span id="503" class="l">                <span class="php-var">$op</span> = <span class="php-quote">'Delete'</span>;
</span><span id="504" class="l">
</span><span id="505" class="l">                <span class="php-var">$salesforce_check</span> = <span class="php-var">$this</span>-&gt;mappings-&gt;load_by_salesforce( <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>] );
</span><span id="506" class="l">
</span><span id="507" class="l">                <span class="php-keyword1">if</span> ( <span class="php-keyword2">count</span>( <span class="php-var">$salesforce_check</span> ) === <span class="php-keyword2">count</span>( <span class="php-var">$salesforce_check</span>, COUNT_RECURSIVE ) ) {
</span><span id="508" class="l">                    <span class="php-keyword1">try</span> {
</span><span id="509" class="l">                        <span class="php-var">$result</span> = <span class="php-var">$sfapi</span>-&gt;object_delete( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>], <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>] );
</span><span id="510" class="l">                    } <span class="php-keyword1">catch</span> ( Object_Sync_Sf_Exception <span class="php-var">$e</span> ) {
</span><span id="511" class="l">                        <span class="php-var">$status</span> = <span class="php-quote">'error'</span>;
</span><span id="512" class="l">                        <span class="php-comment">// create log entry for failed delete</span>
</span><span id="513" class="l">                        <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$this</span>-&gt;logging ) ) {
</span><span id="514" class="l">                            <span class="php-var">$logging</span> = <span class="php-var">$this</span>-&gt;logging;
</span><span id="515" class="l">                        } <span class="php-keyword1">elseif</span> ( <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Logging'</span> ) ) {
</span><span id="516" class="l">                            <span class="php-var">$logging</span> = <span class="php-keyword1">new</span> Object_Sync_Sf_Logging( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version );
</span><span id="517" class="l">                        }
</span><span id="518" class="l">
</span><span id="519" class="l">                        <span class="php-comment">// translators: placeholders are: 1) what operation is happening, 2) the name of the Salesforce object, 3) the Salesforce Id value, 4) the name of the WordPress object type, 5) the WordPress id field name, 6) the WordPress object id value</span>
</span><span id="520" class="l">                        <span class="php-var">$title</span> = <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'Error: %1$s %2$s %3$s (WordPress %4$s with %5$s of %6$s)'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ),
</span><span id="521" class="l">                            esc_attr( <span class="php-var">$op</span> ),
</span><span id="522" class="l">                            esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>] ),
</span><span id="523" class="l">                            esc_attr( <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>] ),
</span><span id="524" class="l">                            esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'wordpress_object'</span>] ),
</span><span id="525" class="l">                            esc_attr( <span class="php-var">$object_id</span> ),
</span><span id="526" class="l">                            esc_attr( <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ] )
</span><span id="527" class="l">                        );
</span><span id="528" class="l">
</span><span id="529" class="l">                        <span class="php-var">$logging</span>-&gt;setup(
</span><span id="530" class="l">                            <span class="php-var">$title</span>,
</span><span id="531" class="l">                            <span class="php-var">$e</span>-&gt;getMessage(),
</span><span id="532" class="l">                            <span class="php-var">$sf_sync_trigger</span>,
</span><span id="533" class="l">                            <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ],
</span><span id="534" class="l">                            <span class="php-var">$status</span>
</span><span id="535" class="l">                        );
</span><span id="536" class="l">
</span><span id="537" class="l">                        <span class="php-comment">// hook for push fail</span>
</span><span id="538" class="l">                        do_action( <span class="php-quote">'object_sync_for_salesforce_push_fail'</span>, <span class="php-var">$op</span>, <span class="php-var">$sfapi</span>-&gt;response, <span class="php-var">$synced_object</span>, <span class="php-var">$object_id</span> );
</span><span id="539" class="l">
</span><span id="540" class="l">                    }
</span><span id="541" class="l">
</span><span id="542" class="l">                    <span class="php-keyword1">if</span> ( ! <span class="php-keyword1">isset</span>( <span class="php-var">$e</span> ) ) {
</span><span id="543" class="l">                        <span class="php-comment">// create log entry for successful delete if the result had no errors</span>
</span><span id="544" class="l">                        <span class="php-var">$status</span> = <span class="php-quote">'success'</span>;
</span><span id="545" class="l">                        <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$this</span>-&gt;logging ) ) {
</span><span id="546" class="l">                            <span class="php-var">$logging</span> = <span class="php-var">$this</span>-&gt;logging;
</span><span id="547" class="l">                        } <span class="php-keyword1">elseif</span> ( <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Logging'</span> ) ) {
</span><span id="548" class="l">                            <span class="php-var">$logging</span> = <span class="php-keyword1">new</span> Object_Sync_Sf_Logging( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version );
</span><span id="549" class="l">                        }
</span><span id="550" class="l">
</span><span id="551" class="l">                        <span class="php-comment">// translators: placeholders are: 1) what operation is happening, 2) the name of the Salesforce object, 3) the Salesforce Id value, 4) the name of the WordPress object type, 5) the WordPress id field name, 6) the WordPress object id value</span>
</span><span id="552" class="l">                        <span class="php-var">$title</span> = <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'Success: %1$s %2$s %3$s (WordPress %4$s with %5$s of %6$s)'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ),
</span><span id="553" class="l">                            esc_attr( <span class="php-var">$op</span> ),
</span><span id="554" class="l">                            esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>] ),
</span><span id="555" class="l">                            esc_attr( <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>] ),
</span><span id="556" class="l">                            esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'wordpress_object'</span>] ),
</span><span id="557" class="l">                            esc_attr( <span class="php-var">$object_id</span> ),
</span><span id="558" class="l">                            esc_attr( <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ] )
</span><span id="559" class="l">                        );
</span><span id="560" class="l">
</span><span id="561" class="l">                        <span class="php-var">$logging</span>-&gt;setup(
</span><span id="562" class="l">                            <span class="php-var">$title</span>,
</span><span id="563" class="l">                            <span class="php-quote">''</span>,
</span><span id="564" class="l">                            <span class="php-var">$sf_sync_trigger</span>,
</span><span id="565" class="l">                            <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ],
</span><span id="566" class="l">                            <span class="php-var">$status</span>
</span><span id="567" class="l">                        );
</span><span id="568" class="l">
</span><span id="569" class="l">                        <span class="php-comment">// hook for push success</span>
</span><span id="570" class="l">                        do_action( <span class="php-quote">'object_sync_for_salesforce_push_success'</span>, <span class="php-var">$op</span>, <span class="php-var">$sfapi</span>-&gt;response, <span class="php-var">$synced_object</span>, <span class="php-var">$object_id</span> );
</span><span id="571" class="l">                    }
</span><span id="572" class="l">                } <span class="php-keyword1">else</span> {
</span><span id="573" class="l">                    <span class="php-var">$more_ids</span> = <span class="php-quote">'&lt;p&gt;The Salesforce record was not deleted because there are multiple WordPress IDs that match this Salesforce ID. They are: '</span>;
</span><span id="574" class="l">                    <span class="php-var">$i</span>        = <span class="php-num">0</span>;
</span><span id="575" class="l">                    <span class="php-keyword1">foreach</span> ( <span class="php-var">$salesforce_check</span> <span class="php-keyword1">as</span> <span class="php-var">$match</span> ) {
</span><span id="576" class="l">                        <span class="php-var">$i</span>++;
</span><span id="577" class="l">                        <span class="php-var">$more_ids</span> .= <span class="php-var">$match</span>[<span class="php-quote">'wordpress_id'</span>];
</span><span id="578" class="l">                        <span class="php-keyword1">if</span> ( <span class="php-keyword2">count</span>( <span class="php-var">$salesforce_check</span> ) !== <span class="php-var">$i</span> ) {
</span><span id="579" class="l">                            <span class="php-var">$more_ids</span> .= <span class="php-quote">', '</span>;
</span><span id="580" class="l">                        } <span class="php-keyword1">else</span> {
</span><span id="581" class="l">                            <span class="php-var">$more_ids</span> .= <span class="php-quote">'.&lt;/p&gt;'</span>;
</span><span id="582" class="l">                        }
</span><span id="583" class="l">                    }
</span><span id="584" class="l">
</span><span id="585" class="l">                    <span class="php-var">$more_ids</span> .= <span class="php-quote">'&lt;p&gt;The map row between this WordPress object and the Salesforce object, as stored in the WordPress database, will be deleted, and this WordPress object has been deleted, but Salesforce will remain untouched.&lt;/p&gt;'</span>;
</span><span id="586" class="l">
</span><span id="587" class="l">                    <span class="php-var">$status</span> = <span class="php-quote">'notice'</span>;
</span><span id="588" class="l">                    <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$this</span>-&gt;logging ) ) {
</span><span id="589" class="l">                        <span class="php-var">$logging</span> = <span class="php-var">$this</span>-&gt;logging;
</span><span id="590" class="l">                    } <span class="php-keyword1">elseif</span> ( <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Logging'</span> ) ) {
</span><span id="591" class="l">                        <span class="php-var">$logging</span> = <span class="php-keyword1">new</span> Object_Sync_Sf_Logging( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version );
</span><span id="592" class="l">                    }
</span><span id="593" class="l">
</span><span id="594" class="l">                    <span class="php-comment">// translators: placeholders are: 1) what operation is happening, 2) the name of the Salesforce object, 3) the Salesforce Id value, 4) the name of the WordPress object type, 5) the WordPress id field name, 6) the WordPress object id value</span>
</span><span id="595" class="l">                    <span class="php-var">$title</span> = <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'Notice: %1$s %2$s %3$s (WordPress %4$s with %5$s of %6$s did not delete the Salesforce item.)'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ),
</span><span id="596" class="l">                        esc_attr( <span class="php-var">$op</span> ),
</span><span id="597" class="l">                        esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>] ),
</span><span id="598" class="l">                        esc_attr( <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>] ),
</span><span id="599" class="l">                        esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'wordpress_object'</span>] ),
</span><span id="600" class="l">                        esc_attr( <span class="php-var">$object_id</span> ),
</span><span id="601" class="l">                        esc_attr( <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ] )
</span><span id="602" class="l">                    );
</span><span id="603" class="l">
</span><span id="604" class="l">                    <span class="php-var">$logging</span>-&gt;setup(
</span><span id="605" class="l">                        <span class="php-var">$title</span>,
</span><span id="606" class="l">                        <span class="php-var">$more_ids</span>,
</span><span id="607" class="l">                        <span class="php-var">$sf_sync_trigger</span>,
</span><span id="608" class="l">                        <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ],
</span><span id="609" class="l">                        <span class="php-var">$status</span>
</span><span id="610" class="l">                    );
</span><span id="611" class="l">                } <span class="php-comment">// End if().</span>
</span><span id="612" class="l">
</span><span id="613" class="l">                <span class="php-comment">// delete the map row from WordPress after the Salesforce row has been deleted</span>
</span><span id="614" class="l">                <span class="php-comment">// we delete the map row even if the Salesforce delete failed, because the WordPress object is gone</span>
</span><span id="615" class="l">                <span class="php-var">$this</span>-&gt;mappings-&gt;delete_object_map( <span class="php-var">$mapping_object</span>[<span class="php-quote">'id'</span>] );
</span><span id="616" class="l">
</span><span id="617" class="l">            } <span class="php-comment">// End if(). there is no map row</span>
</span><span id="618" class="l">
</span><span id="619" class="l">            <span class="php-keyword1">return</span>;
</span><span id="620" class="l">        } <span class="php-comment">// End if().</span>
</span><span id="621" class="l">
</span><span id="622" class="l">        <span class="php-comment">// are these objects already connected in WordPress?</span>
</span><span id="623" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$mapping_object</span>[<span class="php-quote">'id'</span>] ) ) {
</span><span id="624" class="l">            <span class="php-var">$is_new</span> = <span class="php-keyword1">false</span>;
</span><span id="625" class="l">        } <span class="php-keyword1">else</span> {
</span><span id="626" class="l">            <span class="php-var">$is_new</span> = <span class="php-keyword1">true</span>;
</span><span id="627" class="l">        }
</span><span id="628" class="l">
</span><span id="629" class="l">        <span class="php-comment">// map the WordPress values to salesforce fields</span>
</span><span id="630" class="l">        <span class="php-var">$params</span> = <span class="php-var">$this</span>-&gt;mappings-&gt;map_params( <span class="php-var">$mapping</span>, <span class="php-var">$object</span>, <span class="php-var">$sf_sync_trigger</span>, <span class="php-keyword1">false</span>, <span class="php-var">$is_new</span> );
</span><span id="631" class="l">
</span><span id="632" class="l">        <span class="php-comment">// hook to allow other plugins to modify the $params array</span>
</span><span id="633" class="l">        <span class="php-comment">// use hook to map fields between the WordPress and Salesforce objects</span>
</span><span id="634" class="l">        <span class="php-comment">// returns $params.</span>
</span><span id="635" class="l">        <span class="php-var">$params</span> = apply_filters( <span class="php-quote">'object_sync_for_salesforce_push_params_modify'</span>, <span class="php-var">$params</span>, <span class="php-var">$mapping</span>, <span class="php-var">$object</span>, <span class="php-var">$sf_sync_trigger</span>, <span class="php-keyword1">false</span>, <span class="php-var">$is_new</span> );
</span><span id="636" class="l">
</span><span id="637" class="l">        <span class="php-comment">// if we don't get any params, there are no fields that should be sent to Salesforce</span>
</span><span id="638" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword1">empty</span>( <span class="php-var">$params</span> ) ) {
</span><span id="639" class="l">            <span class="php-keyword1">return</span>;
</span><span id="640" class="l">        }
</span><span id="641" class="l">
</span><span id="642" class="l">        <span class="php-comment">// if there is a prematch WordPress field - ie email - on the fieldmap object</span>
</span><span id="643" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$params</span>[<span class="php-quote">'prematch'</span>] ) &amp;&amp; <span class="php-keyword2">is_array</span>( <span class="php-var">$params</span>[<span class="php-quote">'prematch'</span>] ) ) {
</span><span id="644" class="l">            <span class="php-var">$prematch_field_wordpress</span>  = <span class="php-var">$params</span>[<span class="php-quote">'prematch'</span>][<span class="php-quote">'wordpress_field'</span>];
</span><span id="645" class="l">            <span class="php-var">$prematch_field_salesforce</span> = <span class="php-var">$params</span>[<span class="php-quote">'prematch'</span>][<span class="php-quote">'salesforce_field'</span>];
</span><span id="646" class="l">            <span class="php-var">$prematch_value</span>            = <span class="php-var">$params</span>[<span class="php-quote">'prematch'</span>][<span class="php-quote">'value'</span>];
</span><span id="647" class="l">            <span class="php-keyword1">unset</span>( <span class="php-var">$params</span>[<span class="php-quote">'prematch'</span>] );
</span><span id="648" class="l">        }
</span><span id="649" class="l">
</span><span id="650" class="l">        <span class="php-comment">// if there is an external key field in Salesforce - ie mailchimp user id - on the fieldmap object</span>
</span><span id="651" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$params</span>[<span class="php-quote">'key'</span>] ) &amp;&amp; <span class="php-keyword2">is_array</span>( <span class="php-var">$params</span>[<span class="php-quote">'key'</span>] ) ) {
</span><span id="652" class="l">            <span class="php-var">$key_field_wordpress</span>  = <span class="php-var">$params</span>[<span class="php-quote">'key'</span>][<span class="php-quote">'wordpress_field'</span>];
</span><span id="653" class="l">            <span class="php-var">$key_field_salesforce</span> = <span class="php-var">$params</span>[<span class="php-quote">'key'</span>][<span class="php-quote">'salesforce_field'</span>];
</span><span id="654" class="l">            <span class="php-var">$key_value</span>            = <span class="php-var">$params</span>[<span class="php-quote">'key'</span>][<span class="php-quote">'value'</span>];
</span><span id="655" class="l">            <span class="php-keyword1">unset</span>( <span class="php-var">$params</span>[<span class="php-quote">'key'</span>] );
</span><span id="656" class="l">        }
</span><span id="657" class="l">
</span><span id="658" class="l">        <span class="php-var">$seconds</span> = <span class="php-var">$this</span>-&gt;schedule-&gt;get_schedule_frequency_seconds( <span class="php-var">$this</span>-&gt;schedule_name ) + <span class="php-num">60</span>;
</span><span id="659" class="l">
</span><span id="660" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword1">true</span> === <span class="php-var">$is_new</span> ) {
</span><span id="661" class="l">
</span><span id="662" class="l">            <span class="php-comment">// right here we should set the pushing transient</span>
</span><span id="663" class="l">            <span class="php-comment">// this means we have to create the mapping object here as well, and update it with the correct IDs after successful response</span>
</span><span id="664" class="l">            <span class="php-comment">// create the mapping object between the rows</span>
</span><span id="665" class="l">            <span class="php-var">$mapping_object_id</span> = <span class="php-var">$this</span>-&gt;create_object_map( <span class="php-var">$object</span>, <span class="php-var">$object_id</span>, <span class="php-var">$this</span>-&gt;mappings-&gt;generate_temporary_id( <span class="php-quote">'push'</span> ), <span class="php-var">$mapping</span>, <span class="php-keyword1">true</span> );
</span><span id="666" class="l">            set_transient( <span class="php-quote">'salesforce_pushing_'</span> . <span class="php-var">$mapping_object_id</span>, <span class="php-num">1</span>, <span class="php-var">$seconds</span> );
</span><span id="667" class="l">            set_transient( <span class="php-quote">'salesforce_pushing_object_id'</span>, <span class="php-var">$mapping_object_id</span> );
</span><span id="668" class="l">            <span class="php-var">$mapping_object</span> = <span class="php-var">$this</span>-&gt;mappings-&gt;get_object_maps(
</span><span id="669" class="l">                <span class="php-keyword1">array</span>(
</span><span id="670" class="l">                    <span class="php-quote">'id'</span> =&gt; <span class="php-var">$mapping_object_id</span>,
</span><span id="671" class="l">                )
</span><span id="672" class="l">            );
</span><span id="673" class="l">
</span><span id="674" class="l">            <span class="php-comment">// setup SF record type. CampaignMember objects get their Campaign's type</span>
</span><span id="675" class="l">            <span class="php-comment">// i am still a bit confused about this</span>
</span><span id="676" class="l">            <span class="php-keyword1">if</span> ( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_record_type_default'</span>] !== <span class="php-var">$this</span>-&gt;mappings-&gt;salesforce_default_record_type &amp;&amp; <span class="php-keyword1">empty</span>( <span class="php-var">$params</span>[<span class="php-quote">'RecordTypeId'</span>] ) &amp;&amp; ( <span class="php-quote">'CampaignMember'</span> !== <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>] ) ) {
</span><span id="677" class="l">                <span class="php-var">$params</span>[<span class="php-quote">'RecordTypeId'</span>] = <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_record_type_default'</span>];
</span><span id="678" class="l">            }
</span><span id="679" class="l">
</span><span id="680" class="l">            <span class="php-keyword1">try</span> {
</span><span id="681" class="l">
</span><span id="682" class="l">                <span class="php-comment">// hook to allow other plugins to modify the $salesforce_id string here</span>
</span><span id="683" class="l">                <span class="php-comment">// use hook to change the object that is being matched to developer's own criteria</span>
</span><span id="684" class="l">                <span class="php-comment">// ex: match a Salesforce Contact based on a connected email address object</span>
</span><span id="685" class="l">                <span class="php-comment">// returns a $salesforce_id.</span>
</span><span id="686" class="l">                <span class="php-comment">// it should keep NULL if there is no match</span>
</span><span id="687" class="l">                <span class="php-comment">// the function that calls this hook needs to check the mapping to make sure the WordPress object is the right type</span>
</span><span id="688" class="l">                <span class="php-var">$salesforce_id</span> = apply_filters( <span class="php-quote">'object_sync_for_salesforce_find_sf_object_match'</span>, <span class="php-keyword1">null</span>, <span class="php-var">$object</span>, <span class="php-var">$mapping</span>, <span class="php-quote">'push'</span> );
</span><span id="689" class="l">
</span><span id="690" class="l">                <span class="php-comment">// hook to allow other plugins to do something right before Salesforce data is saved</span>
</span><span id="691" class="l">                <span class="php-comment">// ex: run WordPress methods on an object if it exists, or do something in preparation for it if it doesn't</span>
</span><span id="692" class="l">                do_action( <span class="php-quote">'object_sync_for_salesforce_pre_push'</span>, <span class="php-var">$salesforce_id</span>, <span class="php-var">$mapping</span>, <span class="php-var">$object</span>, <span class="php-var">$object_id</span>, <span class="php-var">$params</span> );
</span><span id="693" class="l">
</span><span id="694" class="l">                <span class="php-comment">// hook to allow other plugins to change params on update actions only</span>
</span><span id="695" class="l">                <span class="php-comment">// use hook to map fields between the WordPress and Salesforce objects</span>
</span><span id="696" class="l">                <span class="php-comment">// returns $params.</span>
</span><span id="697" class="l">                <span class="php-var">$params</span> = apply_filters( <span class="php-quote">'object_sync_for_salesforce_push_update_params_modify'</span>, <span class="php-var">$params</span>, <span class="php-var">$salesforce_id</span>, <span class="php-var">$mapping</span>, <span class="php-var">$object</span> );
</span><span id="698" class="l">
</span><span id="699" class="l">                <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$prematch_field_wordpress</span> ) || <span class="php-keyword1">isset</span>( <span class="php-var">$key_field_wordpress</span> ) || <span class="php-keyword1">null</span> !== <span class="php-var">$salesforce_id</span> ) {
</span><span id="700" class="l">
</span><span id="701" class="l">                    <span class="php-comment">// if either prematch criteria exists, make the values queryable</span>
</span><span id="702" class="l">
</span><span id="703" class="l">                    <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$prematch_field_wordpress</span> ) ) {
</span><span id="704" class="l">                        <span class="php-comment">// a prematch has been specified, attempt an upsert().</span>
</span><span id="705" class="l">                        <span class="php-comment">// prematch values with punctuation need to be escaped</span>
</span><span id="706" class="l">                        <span class="php-var">$encoded_prematch_value</span> = <span class="php-keyword2">rawurlencode</span>( <span class="php-var">$prematch_value</span> );
</span><span id="707" class="l">                        <span class="php-comment">// for at least 'email' fields, periods also need to be escaped:</span>
</span><span id="708" class="l">                        <span class="php-comment">// https://developer.salesforce.com/forums?id=906F000000099xPIAQ</span>
</span><span id="709" class="l">                        <span class="php-var">$encoded_prematch_value</span> = <span class="php-keyword2">str_replace</span>( <span class="php-quote">'.'</span>, <span class="php-quote">'%2E'</span>, <span class="php-var">$encoded_prematch_value</span> );
</span><span id="710" class="l">                    }
</span><span id="711" class="l">
</span><span id="712" class="l">                    <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$key_field_wordpress</span> ) ) {
</span><span id="713" class="l">                        <span class="php-comment">// an external key has been specified, attempt an upsert().</span>
</span><span id="714" class="l">                        <span class="php-comment">// external key values with punctuation need to be escaped</span>
</span><span id="715" class="l">                        <span class="php-var">$encoded_key_value</span> = <span class="php-keyword2">rawurlencode</span>( <span class="php-var">$key_value</span> );
</span><span id="716" class="l">                        <span class="php-comment">// for at least 'email' fields, periods also need to be escaped:</span>
</span><span id="717" class="l">                        <span class="php-comment">// https://developer.salesforce.com/forums?id=906F000000099xPIAQ</span>
</span><span id="718" class="l">                        <span class="php-var">$encoded_key_value</span> = <span class="php-keyword2">str_replace</span>( <span class="php-quote">'.'</span>, <span class="php-quote">'%2E'</span>, <span class="php-var">$encoded_key_value</span> );
</span><span id="719" class="l">                    }
</span><span id="720" class="l">
</span><span id="721" class="l">                    <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$prematch_field_wordpress</span> ) ) {
</span><span id="722" class="l">                        <span class="php-var">$upsert_key</span>   = <span class="php-var">$prematch_field_salesforce</span>;
</span><span id="723" class="l">                        <span class="php-var">$upsert_value</span> = <span class="php-var">$encoded_prematch_value</span>;
</span><span id="724" class="l">                    } <span class="php-keyword1">elseif</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$key_field_wordpress</span> ) ) {
</span><span id="725" class="l">                        <span class="php-var">$upsert_key</span>   = <span class="php-var">$key_field_salesforce</span>;
</span><span id="726" class="l">                        <span class="php-var">$upsert_value</span> = <span class="php-var">$encoded_key_value</span>;
</span><span id="727" class="l">                    }
</span><span id="728" class="l">
</span><span id="729" class="l">                    <span class="php-keyword1">if</span> ( <span class="php-keyword1">null</span> !== <span class="php-var">$salesforce_id</span> ) {
</span><span id="730" class="l">                        <span class="php-var">$upsert_key</span>   = <span class="php-quote">'Id'</span>;
</span><span id="731" class="l">                        <span class="php-var">$upsert_value</span> = <span class="php-var">$salesforce_id</span>;
</span><span id="732" class="l">                    }
</span><span id="733" class="l">
</span><span id="734" class="l">                    <span class="php-var">$op</span> = <span class="php-quote">'Upsert'</span>;
</span><span id="735" class="l">
</span><span id="736" class="l">                    <span class="php-var">$result</span> = <span class="php-var">$sfapi</span>-&gt;object_upsert( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>], <span class="php-var">$upsert_key</span>, <span class="php-var">$upsert_value</span>, <span class="php-var">$params</span> );
</span><span id="737" class="l">
</span><span id="738" class="l">                    <span class="php-comment">// Handle upsert responses.</span>
</span><span id="739" class="l">                    <span class="php-keyword1">switch</span> ( <span class="php-var">$sfapi</span>-&gt;response[<span class="php-quote">'code'</span>] ) {
</span><span id="740" class="l">                        <span class="php-comment">// On Upsert:update retrieved object.</span>
</span><span id="741" class="l">                        <span class="php-keyword1">case</span> <span class="php-quote">'204'</span>:
</span><span id="742" class="l">                            <span class="php-var">$sf_object</span>             = <span class="php-var">$sfapi</span>-&gt;object_readby_external_id( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>], <span class="php-var">$upsert_key</span>, <span class="php-var">$upsert_value</span> );
</span><span id="743" class="l">                            <span class="php-var">$salesforce_data</span>[<span class="php-quote">'id'</span>] = <span class="php-var">$sf_object</span>[<span class="php-quote">'data'</span>][<span class="php-quote">'Id'</span>];
</span><span id="744" class="l">                            <span class="php-keyword1">break</span>;
</span><span id="745" class="l">                        <span class="php-comment">// Handle duplicate records.</span>
</span><span id="746" class="l">                        <span class="php-keyword1">case</span> <span class="php-quote">'300'</span>:
</span><span id="747" class="l">                            <span class="php-var">$result</span>[<span class="php-quote">'errorCode'</span>] = <span class="php-var">$sfapi</span>-&gt;response[<span class="php-quote">'error'</span>] . <span class="php-quote">' ('</span> . <span class="php-var">$upsert_key</span> . <span class="php-quote">':'</span> . <span class="php-var">$upsert_value</span> . <span class="php-quote">')'</span>;
</span><span id="748" class="l">                            <span class="php-keyword1">break</span>;
</span><span id="749" class="l">                    }
</span><span id="750" class="l">                } <span class="php-keyword1">else</span> {
</span><span id="751" class="l">                    <span class="php-comment">// No key or prematch field exists on this field map object, create a new object in Salesforce.</span>
</span><span id="752" class="l">                    <span class="php-var">$op</span>     = <span class="php-quote">'Create'</span>;
</span><span id="753" class="l">                    <span class="php-var">$result</span> = <span class="php-var">$sfapi</span>-&gt;object_create( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>], <span class="php-var">$params</span> );
</span><span id="754" class="l">                } <span class="php-comment">// End if().</span>
</span><span id="755" class="l">            } <span class="php-keyword1">catch</span> ( Object_Sync_Sf_Exception <span class="php-var">$e</span> ) {
</span><span id="756" class="l">                <span class="php-comment">// create log entry for failed create or upsert</span>
</span><span id="757" class="l">                <span class="php-var">$status</span> = <span class="php-quote">'error'</span>;
</span><span id="758" class="l">
</span><span id="759" class="l">                <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$this</span>-&gt;logging ) ) {
</span><span id="760" class="l">                    <span class="php-var">$logging</span> = <span class="php-var">$this</span>-&gt;logging;
</span><span id="761" class="l">                } <span class="php-keyword1">elseif</span> ( <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Logging'</span> ) ) {
</span><span id="762" class="l">                    <span class="php-var">$logging</span> = <span class="php-keyword1">new</span> Object_Sync_Sf_Logging( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version );
</span><span id="763" class="l">                }
</span><span id="764" class="l">
</span><span id="765" class="l">                <span class="php-comment">// translators: placeholders are: 1) what operation is happening, 2) the name of the Salesforce object, 3) the Salesforce Id value if there is one, 4) the name of the WordPress object type, 5) the WordPress id field name, 6) the WordPress object id value</span>
</span><span id="766" class="l">                <span class="php-var">$title</span> = <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'Error: %1$s %2$s %3$s (WordPress %4$s with %5$s of %6$s)'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ),
</span><span id="767" class="l">                    esc_attr( <span class="php-var">$op</span> ),
</span><span id="768" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>] ),
</span><span id="769" class="l">                    <span class="php-keyword1">isset</span>( <span class="php-var">$salesforce_id</span> ) ? <span class="php-quote">' '</span> . esc_attr( <span class="php-var">$salesforce_id</span> ) : <span class="php-quote">''</span>,
</span><span id="770" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'wordpress_object'</span>] ),
</span><span id="771" class="l">                    esc_attr( <span class="php-var">$object_id</span> ),
</span><span id="772" class="l">                    esc_attr( <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ] )
</span><span id="773" class="l">                );
</span><span id="774" class="l">
</span><span id="775" class="l">                <span class="php-var">$logging</span>-&gt;setup(
</span><span id="776" class="l">                    <span class="php-var">$title</span>,
</span><span id="777" class="l">                    <span class="php-var">$e</span>-&gt;getMessage(),
</span><span id="778" class="l">                    <span class="php-var">$sf_sync_trigger</span>,
</span><span id="779" class="l">                    <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ],
</span><span id="780" class="l">                    <span class="php-var">$status</span>
</span><span id="781" class="l">                );
</span><span id="782" class="l">
</span><span id="783" class="l">                <span class="php-comment">// hook for push fail</span>
</span><span id="784" class="l">                do_action( <span class="php-quote">'object_sync_for_salesforce_push_fail'</span>, <span class="php-var">$op</span>, <span class="php-var">$sfapi</span>-&gt;response, <span class="php-var">$synced_object</span> );
</span><span id="785" class="l">
</span><span id="786" class="l">                <span class="php-keyword1">return</span>;
</span><span id="787" class="l">            } <span class="php-comment">// End try().</span>
</span><span id="788" class="l">
</span><span id="789" class="l">            <span class="php-keyword1">if</span> ( ! <span class="php-keyword1">isset</span>( <span class="php-var">$salesforce_data</span> ) ) {
</span><span id="790" class="l">                <span class="php-comment">// if we didn't set $salesforce_data already, set it now to api call result</span>
</span><span id="791" class="l">                <span class="php-var">$salesforce_data</span> = <span class="php-var">$result</span>[<span class="php-quote">'data'</span>];
</span><span id="792" class="l">            }
</span><span id="793" class="l">
</span><span id="794" class="l">            <span class="php-comment">// Salesforce api call was successful</span>
</span><span id="795" class="l">            <span class="php-comment">// this means the object has already been created/updated in Salesforce</span>
</span><span id="796" class="l">            <span class="php-comment">// this is not redundant because this is where it creates the object mapping rows in WordPress if the object does not already have one (we are still inside $is_new === TRUE here)</span>
</span><span id="797" class="l">
</span><span id="798" class="l">            <span class="php-keyword1">if</span> ( <span class="php-keyword1">empty</span>( <span class="php-var">$result</span>[<span class="php-quote">'errorCode'</span>] ) ) {
</span><span id="799" class="l">                <span class="php-var">$salesforce_id</span> = <span class="php-var">$salesforce_data</span>[<span class="php-quote">'id'</span>];
</span><span id="800" class="l">                <span class="php-var">$status</span>        = <span class="php-quote">'success'</span>;
</span><span id="801" class="l">
</span><span id="802" class="l">                <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$this</span>-&gt;logging ) ) {
</span><span id="803" class="l">                    <span class="php-var">$logging</span> = <span class="php-var">$this</span>-&gt;logging;
</span><span id="804" class="l">                } <span class="php-keyword1">elseif</span> ( <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Logging'</span> ) ) {
</span><span id="805" class="l">                    <span class="php-var">$logging</span> = <span class="php-keyword1">new</span> Object_Sync_Sf_Logging( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version );
</span><span id="806" class="l">                }
</span><span id="807" class="l">
</span><span id="808" class="l">                <span class="php-comment">// translators: placeholders are: 1) what operation is happening, 2) the name of the Salesforce object, 3) the Salesforce Id value, 4) the name of the WordPress object type, 5) the WordPress id field name, 6) the WordPress object id value</span>
</span><span id="809" class="l">                <span class="php-var">$title</span> = <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'Success: %1$s %2$s %3$s (WordPress %4$s with %5$s of %6$s)'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ),
</span><span id="810" class="l">                    esc_attr( <span class="php-var">$op</span> ),
</span><span id="811" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>] ),
</span><span id="812" class="l">                    esc_attr( <span class="php-var">$salesforce_id</span> ),
</span><span id="813" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'wordpress_object'</span>] ),
</span><span id="814" class="l">                    esc_attr( <span class="php-var">$object_id</span> ),
</span><span id="815" class="l">                    esc_attr( <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ] )
</span><span id="816" class="l">                );
</span><span id="817" class="l">
</span><span id="818" class="l">                <span class="php-var">$logging</span>-&gt;setup(
</span><span id="819" class="l">                    <span class="php-var">$title</span>,
</span><span id="820" class="l">                    <span class="php-quote">''</span>,
</span><span id="821" class="l">                    <span class="php-var">$sf_sync_trigger</span>,
</span><span id="822" class="l">                    <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ],
</span><span id="823" class="l">                    <span class="php-var">$status</span>
</span><span id="824" class="l">                );
</span><span id="825" class="l">
</span><span id="826" class="l">                <span class="php-comment">// update that mapping object</span>
</span><span id="827" class="l">                <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>]     = <span class="php-var">$salesforce_id</span>;
</span><span id="828" class="l">                <span class="php-var">$mapping_object</span>[<span class="php-quote">'last_sync_message'</span>] = esc_html__( <span class="php-quote">'Mapping object updated via function: '</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ) . __FUNCTION__;
</span><span id="829" class="l">                <span class="php-var">$mapping_object</span>                      = <span class="php-var">$this</span>-&gt;mappings-&gt;update_object_map( <span class="php-var">$mapping_object</span>, <span class="php-var">$mapping_object</span>[<span class="php-quote">'id'</span>] );
</span><span id="830" class="l">
</span><span id="831" class="l">                <span class="php-comment">// hook for push success</span>
</span><span id="832" class="l">                do_action( <span class="php-quote">'object_sync_for_salesforce_push_success'</span>, <span class="php-var">$op</span>, <span class="php-var">$sfapi</span>-&gt;response, <span class="php-var">$synced_object</span>, <span class="php-var">$object_id</span> );
</span><span id="833" class="l">            } <span class="php-keyword1">else</span> {
</span><span id="834" class="l">
</span><span id="835" class="l">                <span class="php-comment">// create log entry for failed create or upsert</span>
</span><span id="836" class="l">                <span class="php-comment">// this is part of the drupal module but i am failing to understand when it would ever fire, since the catch should catch the errors</span>
</span><span id="837" class="l">                <span class="php-comment">// if we see this in the log entries, we can understand what it does, but probably not until then</span>
</span><span id="838" class="l">                <span class="php-var">$status</span> = <span class="php-quote">'error'</span>;
</span><span id="839" class="l">                <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$this</span>-&gt;logging ) ) {
</span><span id="840" class="l">                    <span class="php-var">$logging</span> = <span class="php-var">$this</span>-&gt;logging;
</span><span id="841" class="l">                } <span class="php-keyword1">elseif</span> ( <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Logging'</span> ) ) {
</span><span id="842" class="l">                    <span class="php-var">$logging</span> = <span class="php-keyword1">new</span> Object_Sync_Sf_Logging( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version );
</span><span id="843" class="l">                }
</span><span id="844" class="l">
</span><span id="845" class="l">                <span class="php-comment">// translators: placeholders are: 1) error code the Salesforce API returned, 2) what operation is happening, 3) the name of the WordPress object type, 4) the WordPress id field name, 5) the WordPress object id value</span>
</span><span id="846" class="l">                <span class="php-var">$title</span> = <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'%1$s error syncing: %2$s to Salesforce (WordPress %3$s with %4$s of %5$s)'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ),
</span><span id="847" class="l">                    absint( <span class="php-var">$salesforce_data</span>[<span class="php-quote">'errorCode'</span>] ),
</span><span id="848" class="l">                    esc_attr( <span class="php-var">$op</span> ),
</span><span id="849" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'wordpress_object'</span>] ),
</span><span id="850" class="l">                    esc_attr( <span class="php-var">$object_id</span> ),
</span><span id="851" class="l">                    esc_attr( <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ] )
</span><span id="852" class="l">                );
</span><span id="853" class="l">
</span><span id="854" class="l">                <span class="php-comment">// translators: placeholders are 1) the name of the Salesforce object type, 2) the error message returned from the Salesforce APIs</span>
</span><span id="855" class="l">                <span class="php-var">$body</span> = <span class="php-keyword2">sprintf</span>( <span class="php-quote">'&lt;p&gt;'</span> . esc_html__( <span class="php-quote">'Object: %1$s'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ) . <span class="php-quote">'&lt;/p&gt;&lt;p&gt;'</span> . esc_html__( <span class="php-quote">'Message: %2$s'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ) . <span class="php-quote">'&lt;/p&gt;'</span>,
</span><span id="856" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>] ),
</span><span id="857" class="l">                    esc_html( <span class="php-var">$salesforce_data</span>[<span class="php-quote">'message'</span>] )
</span><span id="858" class="l">                );
</span><span id="859" class="l">
</span><span id="860" class="l">                <span class="php-var">$logging</span>-&gt;setup(
</span><span id="861" class="l">                    <span class="php-var">$title</span>,
</span><span id="862" class="l">                    <span class="php-var">$body</span>,
</span><span id="863" class="l">                    <span class="php-var">$sf_sync_trigger</span>,
</span><span id="864" class="l">                    <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ],
</span><span id="865" class="l">                    <span class="php-var">$status</span>
</span><span id="866" class="l">                );
</span><span id="867" class="l">
</span><span id="868" class="l">                <span class="php-comment">// hook for push fail</span>
</span><span id="869" class="l">                do_action( <span class="php-quote">'object_sync_for_salesforce_push_fail'</span>, <span class="php-var">$op</span>, <span class="php-var">$sfapi</span>-&gt;response, <span class="php-var">$synced_object</span> );
</span><span id="870" class="l">
</span><span id="871" class="l">                <span class="php-keyword1">return</span>;
</span><span id="872" class="l">            } <span class="php-comment">// End if().</span>
</span><span id="873" class="l">        } <span class="php-keyword1">else</span> {
</span><span id="874" class="l">            <span class="php-comment">// $is_new is false here; we are updating an already mapped object</span>
</span><span id="875" class="l">
</span><span id="876" class="l">            <span class="php-comment">// right here we should set the pushing transient</span>
</span><span id="877" class="l">            set_transient( <span class="php-quote">'salesforce_pushing_'</span> . <span class="php-var">$mapping_object</span>[<span class="php-quote">'id'</span>], <span class="php-num">1</span>, <span class="php-var">$seconds</span> );
</span><span id="878" class="l">            set_transient( <span class="php-quote">'salesforce_pushing_object_id'</span>, <span class="php-var">$mapping_object</span>[<span class="php-quote">'id'</span>] );
</span><span id="879" class="l">
</span><span id="880" class="l">            <span class="php-comment">// there is an existing object link</span>
</span><span id="881" class="l">            <span class="php-comment">// if the last sync is greater than the last time this object was updated, skip it</span>
</span><span id="882" class="l">            <span class="php-comment">// this keeps us from doing redundant syncs</span>
</span><span id="883" class="l">            <span class="php-var">$mapping_object</span>[<span class="php-quote">'object_updated'</span>] = current_time( <span class="php-quote">'mysql'</span> );
</span><span id="884" class="l">            <span class="php-keyword1">if</span> ( <span class="php-var">$mapping_object</span>[<span class="php-quote">'last_sync'</span>] &gt; <span class="php-var">$mapping_object</span>[<span class="php-quote">'object_updated'</span>] ) {
</span><span id="885" class="l">                <span class="php-var">$status</span> = <span class="php-quote">'notice'</span>;
</span><span id="886" class="l">                <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$this</span>-&gt;logging ) ) {
</span><span id="887" class="l">                    <span class="php-var">$logging</span> = <span class="php-var">$this</span>-&gt;logging;
</span><span id="888" class="l">                } <span class="php-keyword1">elseif</span> ( <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Logging'</span> ) ) {
</span><span id="889" class="l">                    <span class="php-var">$logging</span> = <span class="php-keyword1">new</span> Object_Sync_Sf_Logging( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version );
</span><span id="890" class="l">                }
</span><span id="891" class="l">
</span><span id="892" class="l">                <span class="php-comment">// translators: placeholders are: 1) what operation is happening, 2) the name of the WordPress object type, 3) the WordPress id field name, 4) the WordPress object id value, 5) the Salesforce Id value</span>
</span><span id="893" class="l">                <span class="php-var">$title</span> = <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'Notice: %1$s: Did not sync WordPress %2$s with %3$s of %4$s with Salesforce Id %5$s because the last sync timestamp was greater than the object updated timestamp.'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ),
</span><span id="894" class="l">                    esc_attr( <span class="php-var">$op</span> ),
</span><span id="895" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'wordpress_object'</span>] ),
</span><span id="896" class="l">                    esc_attr( <span class="php-var">$object_id</span> ),
</span><span id="897" class="l">                    esc_attr( <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ] ),
</span><span id="898" class="l">                    esc_attr( <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>] )
</span><span id="899" class="l">                );
</span><span id="900" class="l">
</span><span id="901" class="l">                <span class="php-comment">// translators: placeholders are 1) when a sync on this mapping last occured, 2) when the object was last updated</span>
</span><span id="902" class="l">                <span class="php-var">$body</span> = <span class="php-keyword2">sprintf</span>( <span class="php-quote">'&lt;p&gt;'</span> . esc_html__( <span class="php-quote">'Last sync time: %1$s'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ) . <span class="php-quote">'&lt;/p&gt;&lt;p&gt;'</span> . esc_html__( <span class="php-quote">'Object updated time: %2$s'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ) . <span class="php-quote">'&lt;/p&gt;'</span>,
</span><span id="903" class="l">                    esc_attr( <span class="php-var">$mapping_object</span>[<span class="php-quote">'last_sync'</span>] ),
</span><span id="904" class="l">                    esc_html( <span class="php-var">$mapping_object</span>[<span class="php-quote">'object_updated'</span>] )
</span><span id="905" class="l">                );
</span><span id="906" class="l">
</span><span id="907" class="l">                <span class="php-var">$logging</span>-&gt;setup(
</span><span id="908" class="l">                    <span class="php-var">$title</span>,
</span><span id="909" class="l">                    <span class="php-var">$body</span>,
</span><span id="910" class="l">                    <span class="php-var">$sf_sync_trigger</span>,
</span><span id="911" class="l">                    <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ],
</span><span id="912" class="l">                    <span class="php-var">$status</span>
</span><span id="913" class="l">                );
</span><span id="914" class="l">                <span class="php-keyword1">return</span>;
</span><span id="915" class="l">            }
</span><span id="916" class="l">
</span><span id="917" class="l">            <span class="php-comment">// try to make a Salesforce update call</span>
</span><span id="918" class="l">            <span class="php-keyword1">try</span> {
</span><span id="919" class="l">
</span><span id="920" class="l">                <span class="php-comment">// hook to allow other plugins to do something right before Salesforce data is saved</span>
</span><span id="921" class="l">                <span class="php-comment">// ex: run WordPress methods on an object if it exists, or do something in preparation for it if it doesn't</span>
</span><span id="922" class="l">                do_action( <span class="php-quote">'object_sync_for_salesforce_pre_push'</span>, <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>], <span class="php-var">$mapping</span>, <span class="php-var">$object</span>, <span class="php-var">$object_id</span>, <span class="php-var">$params</span> );
</span><span id="923" class="l">
</span><span id="924" class="l">                <span class="php-comment">// hook to allow other plugins to change params on update actions only</span>
</span><span id="925" class="l">                <span class="php-comment">// use hook to map fields between the WordPress and Salesforce objects</span>
</span><span id="926" class="l">                <span class="php-comment">// returns $params.</span>
</span><span id="927" class="l">                <span class="php-var">$params</span> = apply_filters( <span class="php-quote">'object_sync_for_salesforce_push_update_params_modify'</span>, <span class="php-var">$params</span>, <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>], <span class="php-var">$mapping</span>, <span class="php-var">$object</span> );
</span><span id="928" class="l">
</span><span id="929" class="l">                <span class="php-var">$op</span>     = <span class="php-quote">'Update'</span>;
</span><span id="930" class="l">                <span class="php-var">$result</span> = <span class="php-var">$sfapi</span>-&gt;object_update( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>], <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>], <span class="php-var">$params</span> );
</span><span id="931" class="l">
</span><span id="932" class="l">                <span class="php-var">$mapping_object</span>[<span class="php-quote">'last_sync_status'</span>]  = <span class="php-var">$this</span>-&gt;mappings-&gt;status_success;
</span><span id="933" class="l">                <span class="php-var">$mapping_object</span>[<span class="php-quote">'last_sync_message'</span>] = esc_html__( <span class="php-quote">'Mapping object updated via function: '</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ) . __FUNCTION__;
</span><span id="934" class="l">
</span><span id="935" class="l">                <span class="php-var">$status</span> = <span class="php-quote">'success'</span>;
</span><span id="936" class="l">                <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$this</span>-&gt;logging ) ) {
</span><span id="937" class="l">                    <span class="php-var">$logging</span> = <span class="php-var">$this</span>-&gt;logging;
</span><span id="938" class="l">                } <span class="php-keyword1">elseif</span> ( <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Logging'</span> ) ) {
</span><span id="939" class="l">                    <span class="php-var">$logging</span> = <span class="php-keyword1">new</span> Object_Sync_Sf_Logging( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version );
</span><span id="940" class="l">                }
</span><span id="941" class="l">
</span><span id="942" class="l">                <span class="php-comment">// translators: placeholders are: 1) what operation is happening, 2) the name of the Salesforce object, 3) the Salesforce Id value, 4) the name of the WordPress object type, 5) the WordPress id field name, 6) the WordPress object id value</span>
</span><span id="943" class="l">                <span class="php-var">$title</span> = <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'Success: %1$s %2$s %3$s (WordPress %4$s with %5$s of %6$s)'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ),
</span><span id="944" class="l">                    esc_attr( <span class="php-var">$op</span> ),
</span><span id="945" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>] ),
</span><span id="946" class="l">                    esc_attr( <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>] ),
</span><span id="947" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'wordpress_object'</span>] ),
</span><span id="948" class="l">                    esc_attr( <span class="php-var">$object_id</span> ),
</span><span id="949" class="l">                    esc_attr( <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ] )
</span><span id="950" class="l">                );
</span><span id="951" class="l">
</span><span id="952" class="l">                <span class="php-var">$logging</span>-&gt;setup(
</span><span id="953" class="l">                    <span class="php-var">$title</span>,
</span><span id="954" class="l">                    <span class="php-quote">''</span>,
</span><span id="955" class="l">                    <span class="php-var">$sf_sync_trigger</span>,
</span><span id="956" class="l">                    <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ],
</span><span id="957" class="l">                    <span class="php-var">$status</span>
</span><span id="958" class="l">                );
</span><span id="959" class="l">
</span><span id="960" class="l">                <span class="php-comment">// hook for push success</span>
</span><span id="961" class="l">                do_action( <span class="php-quote">'object_sync_for_salesforce_push_success'</span>, <span class="php-var">$op</span>, <span class="php-var">$sfapi</span>-&gt;response, <span class="php-var">$synced_object</span>, <span class="php-var">$object_id</span> );
</span><span id="962" class="l">
</span><span id="963" class="l">            } <span class="php-keyword1">catch</span> ( Object_Sync_Sf_Exception <span class="php-var">$e</span> ) {
</span><span id="964" class="l">                <span class="php-comment">// create log entry for failed update</span>
</span><span id="965" class="l">                <span class="php-var">$status</span> = <span class="php-quote">'error'</span>;
</span><span id="966" class="l">                <span class="php-keyword1">if</span> ( <span class="php-keyword1">isset</span>( <span class="php-var">$this</span>-&gt;logging ) ) {
</span><span id="967" class="l">                    <span class="php-var">$logging</span> = <span class="php-var">$this</span>-&gt;logging;
</span><span id="968" class="l">                } <span class="php-keyword1">elseif</span> ( <span class="php-keyword2">class_exists</span>( <span class="php-quote">'Object_Sync_Sf_Logging'</span> ) ) {
</span><span id="969" class="l">                    <span class="php-var">$logging</span> = <span class="php-keyword1">new</span> Object_Sync_Sf_Logging( <span class="php-var">$this</span>-&gt;wpdb, <span class="php-var">$this</span>-&gt;version );
</span><span id="970" class="l">                }
</span><span id="971" class="l">
</span><span id="972" class="l">                <span class="php-comment">// translators: placeholders are: 1) what operation is happening, 2) the name of the Salesforce object, 3) the Salesforce Id value, 4) the name of the WordPress object type, 5) the WordPress id field name, 6) the WordPress object id value</span>
</span><span id="973" class="l">                <span class="php-var">$title</span> = <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'Error: %1$s %2$s %3$s (WordPress %4$s with %5$s of %6$s)'</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ),
</span><span id="974" class="l">                    esc_attr( <span class="php-var">$op</span> ),
</span><span id="975" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'salesforce_object'</span>] ),
</span><span id="976" class="l">                    esc_attr( <span class="php-var">$mapping_object</span>[<span class="php-quote">'salesforce_id'</span>] ),
</span><span id="977" class="l">                    esc_attr( <span class="php-var">$mapping</span>[<span class="php-quote">'wordpress_object'</span>] ),
</span><span id="978" class="l">                    esc_attr( <span class="php-var">$object_id</span> ),
</span><span id="979" class="l">                    esc_attr( <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ] )
</span><span id="980" class="l">                );
</span><span id="981" class="l">
</span><span id="982" class="l">                <span class="php-var">$logging</span>-&gt;setup(
</span><span id="983" class="l">                    <span class="php-var">$title</span>,
</span><span id="984" class="l">                    <span class="php-var">$e</span>-&gt;getMessage(),
</span><span id="985" class="l">                    <span class="php-var">$sf_sync_trigger</span>,
</span><span id="986" class="l">                    <span class="php-var">$object</span>[ <span class="php-quote">&quot;</span><span class="php-var">$object_id</span><span class="php-quote">&quot;</span> ],
</span><span id="987" class="l">                    <span class="php-var">$status</span>
</span><span id="988" class="l">                );
</span><span id="989" class="l">
</span><span id="990" class="l">                <span class="php-var">$mapping_object</span>[<span class="php-quote">'last_sync_status'</span>]  = <span class="php-var">$this</span>-&gt;mappings-&gt;status_error;
</span><span id="991" class="l">                <span class="php-var">$mapping_object</span>[<span class="php-quote">'last_sync_message'</span>] = <span class="php-var">$e</span>-&gt;getMessage();
</span><span id="992" class="l">
</span><span id="993" class="l">                <span class="php-comment">// hook for push fail</span>
</span><span id="994" class="l">                do_action( <span class="php-quote">'object_sync_for_salesforce_push_fail'</span>, <span class="php-var">$op</span>, <span class="php-var">$sfapi</span>-&gt;response, <span class="php-var">$synced_object</span> );
</span><span id="995" class="l">
</span><span id="996" class="l">            } <span class="php-comment">// End try().</span>
</span><span id="997" class="l">
</span><span id="998" class="l">            <span class="php-comment">// tell the mapping object - whether it is new or already existed - how we just used it</span>
</span><span id="999" class="l">            <span class="php-var">$mapping_object</span>[<span class="php-quote">'last_sync_action'</span>] = <span class="php-quote">'push'</span>;
</span><span id="1000" class="l">            <span class="php-var">$mapping_object</span>[<span class="php-quote">'last_sync'</span>]        = current_time( <span class="php-quote">'mysql'</span> );
</span><span id="1001" class="l">
</span><span id="1002" class="l">            <span class="php-comment">// update that mapping object</span>
</span><span id="1003" class="l">            <span class="php-var">$result</span> = <span class="php-var">$this</span>-&gt;mappings-&gt;update_object_map( <span class="php-var">$mapping_object</span>, <span class="php-var">$mapping_object</span>[<span class="php-quote">'id'</span>] );
</span><span id="1004" class="l">
</span><span id="1005" class="l">        } <span class="php-comment">// End if(). this is the end of the if is_new stuff</span>
</span><span id="1006" class="l">
</span><span id="1007" class="l">    }
</span><span id="1008" class="l">
</span><span id="1009" class="l">    <span class="php-comment">/**
</span></span><span id="1010" class="l"><span class="php-comment">    * Create an object map between a WordPress object and a Salesforce object
</span></span><span id="1011" class="l"><span class="php-comment">    *
</span></span><span id="1012" class="l"><span class="php-comment">    * @param array $wordpress_object
</span></span><span id="1013" class="l"><span class="php-comment">    *   Array of the WordPress object's data
</span></span><span id="1014" class="l"><span class="php-comment">    * @param string $id_field_name
</span></span><span id="1015" class="l"><span class="php-comment">    *   How this object names its primary field. ie Id or comment_id or whatever
</span></span><span id="1016" class="l"><span class="php-comment">    * @param string $salesforce_id
</span></span><span id="1017" class="l"><span class="php-comment">    *   Unique identifier for the Salesforce object
</span></span><span id="1018" class="l"><span class="php-comment">    * @param array $field_mapping
</span></span><span id="1019" class="l"><span class="php-comment">    *   The row that maps the object types together, including which fields match which other fields
</span></span><span id="1020" class="l"><span class="php-comment">    *
</span></span><span id="1021" class="l"><span class="php-comment">    * @return int $wpdb-&gt;insert_id
</span></span><span id="1022" class="l"><span class="php-comment">    *   This is the database row for the map object
</span></span><span id="1023" class="l"><span class="php-comment">    *
</span></span><span id="1024" class="l"><span class="php-comment">    */</span>
</span><span id="1025" class="l">    <span class="php-keyword1">private</span> <span class="php-keyword1">function</span> create_object_map( <span class="php-var">$wordpress_object</span>, <span class="php-var">$id_field_name</span>, <span class="php-var">$salesforce_id</span>, <span class="php-var">$field_mapping</span>, <span class="php-var">$pending</span> = <span class="php-keyword1">false</span> ) {
</span><span id="1026" class="l">
</span><span id="1027" class="l">        <span class="php-keyword1">if</span> ( <span class="php-keyword1">true</span> === <span class="php-var">$pending</span> ) {
</span><span id="1028" class="l">            <span class="php-var">$action</span> = <span class="php-quote">'pending'</span>;
</span><span id="1029" class="l">        } <span class="php-keyword1">else</span> {
</span><span id="1030" class="l">            <span class="php-var">$action</span> = <span class="php-quote">'created'</span>;
</span><span id="1031" class="l">        }
</span><span id="1032" class="l">
</span><span id="1033" class="l">        <span class="php-comment">// Create object map and save it</span>
</span><span id="1034" class="l">        <span class="php-var">$mapping_object</span> = <span class="php-var">$this</span>-&gt;mappings-&gt;create_object_map(
</span><span id="1035" class="l">            <span class="php-keyword1">array</span>(
</span><span id="1036" class="l">                <span class="php-quote">'wordpress_id'</span>      =&gt; <span class="php-var">$wordpress_object</span>[ <span class="php-var">$id_field_name</span> ], <span class="php-comment">// wordpress unique id</span>
</span><span id="1037" class="l">                <span class="php-quote">'salesforce_id'</span>     =&gt; <span class="php-var">$salesforce_id</span>, <span class="php-comment">// salesforce unique id. we don't care what kind of object it is at this point</span>
</span><span id="1038" class="l">                <span class="php-quote">'wordpress_object'</span>  =&gt; <span class="php-var">$field_mapping</span>[<span class="php-quote">'wordpress_object'</span>], <span class="php-comment">// keep track of what kind of wp object this is</span>
</span><span id="1039" class="l">                <span class="php-quote">'last_sync'</span>         =&gt; current_time( <span class="php-quote">'mysql'</span> ),
</span><span id="1040" class="l">                <span class="php-quote">'last_sync_action'</span>  =&gt; <span class="php-quote">'push'</span>,
</span><span id="1041" class="l">                <span class="php-quote">'last_sync_status'</span>  =&gt; <span class="php-var">$this</span>-&gt;mappings-&gt;status_success,
</span><span id="1042" class="l">                <span class="php-comment">// translators: placeholder is for the action that occurred on the mapping object (pending or created)</span>
</span><span id="1043" class="l">                <span class="php-quote">'last_sync_message'</span> =&gt; <span class="php-keyword2">sprintf</span>( esc_html__( <span class="php-quote">'Mapping object %1$s via function: '</span>, <span class="php-quote">'object-sync-for-salesforce'</span> ) . __FUNCTION__,
</span><span id="1044" class="l">                    esc_attr( <span class="php-var">$action</span> )
</span><span id="1045" class="l">                ),
</span><span id="1046" class="l">                <span class="php-quote">'action'</span>            =&gt; <span class="php-var">$action</span>,
</span><span id="1047" class="l">            )
</span><span id="1048" class="l">        );
</span><span id="1049" class="l">
</span><span id="1050" class="l">        <span class="php-keyword1">return</span> <span class="php-var">$mapping_object</span>;
</span><span id="1051" class="l">
</span><span id="1052" class="l">    }
</span><span id="1053" class="l">
</span><span id="1054" class="l">}
</span><span id="1055" class="l"></span></code></pre>

	<div id="footer">
		Object Sync for Salesforce API documentation generated by <a href="http://apigen.org">ApiGen</a>
	</div>
</div>
</div>
<script src="resources/combined.js?accf70cfac0fe15b4c80f6039ece408b240e9042"></script>
<script src="elementlist.js?04aa35b40ab3986ede0da77d700f9b59bb72cde5"></script>
</body>
</html>
